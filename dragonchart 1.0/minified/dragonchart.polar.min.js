if(!window.DChart){throw new Error('未能加载dragonchart.core.js，该js必须在其他DChart框架的js加载之前被引用。\n'+'Not loaded dragonchart.core.js which must be loaded before other DChart\'s js.');}else{DChart.Const.Skins.BlackAndWhite.Polar={SepareateLineColor:null,OuterLabelColor:null,OuterLabelBorderColor:null,OuterLabelBackColor:'rgba(255,255,255,0.3)',StaffFontColor:null,StaffBackColor:null,ScaleLineColors:null}}DChart.Polar=DChart.getCore().__extends({GraphType:'Polar',SetDefaultOptions:function(){this._resetSharedOpions();this.innerOptions=DChart.Methods.Extend(this.originalDefaultOptions,{radius:null,margin:null,colors:null,animateRotate:true,animateScale:true,scaleOverlay:true,startAngle:null,averageAngle:false,separeateLine:{show:false,color:null,width:null},scale:{linewidth:0.5,minvalue:null,maxvalue:null,interval:null,linecolors:null},staff:{show:true,content:function(a){return a.toString()},fontcolor:null,fontfamily:null,fontsize:null,fontweight:null,directions:['n','s','e','w'],backcolor:'rgba(255,255,255,0.3)'},outerLabel:{show:true,content:function(a){return a.text+' '+a.percent.toFixed(1)+'%'},withlegend:true,legendtype:null,length:null,color:null,backcolor:'rgba(220,220,220,0.2)',bordercolor:null,borderwidth:0.5,fontsize:null,fontfamily:null}});return this},Draw:function(w,z){var A=this;if(arguments.length===1){if(!DChart.Methods.IsArray(arguments[0])){z=arguments[0];w=undefined}}A.SetOptions(z);A._checkOptions();var B=A.innerOptions;if(!B.animateRotate&&!B.animateScale){B.animation=false}A.SetData(w);A._onStart();var C=null;var D=null;var E=A.innerData.length;var F=0;for(var i=0;i<E;i++){var G=A.innerData[i];var H=G.value;if(typeof H!='number'){throw new Error(DChart.Const.Language[A.Language].WrongData+'\''+H+'\''+DChart.Const.Language[A.Language].NeedNumberData);}else if(H<0){throw new Error(DChart.Const.Language[A.Language].WrongData+'\''+H+'\''+DChart.Const.Language[A.Language].DataMustGreaterThanZero);}else{F+=H;if(D==null){C=D=H}else{if(H>D){D=H}else if(H<C){C=H}}}}var I=A._getComputed(0,'n',B.scale,C,D,8);var J=A._getDrawableCoordinate();var K=DChart.Methods.IsNumber(B.margin)&&B.margin>0?B.margin:15;var L=Math.min((J.maxX-J.minX)/3,(J.maxY-J.minY)/2)-K*2;var M=B.radius&&B.radius<L?B.radius:L;A.coordinates.draw=J;A.coordinates.polar={radius:M,centerX:J.centerX,centerY:J.centerY};var N=(B.colors&&B.colors.length>0?B.colors:null)||DChart.Const.Defaults.FillColors;if(N){A.tempData.legendColors=N}var O=A.ctx;A.coordinates.polar.outerlabels=[];A.coordinates.polar.staff=[];A.coordinates.polar.cemicircles=[];A.shapes.cemicircles=[];A.shapes.outerLabels=[];var P=3;var Q=3;var R=true;var S=function(f,g,h,i,j){this.index=f;this.angleMin=g;this.angleMax=h;this.data=i;this.isHovered=false;this.radius=j;this.color=function(){return this.data.color||N[this.index%N.length]};this.redraw=function(a,b){V(U(this.data.value),this.angleMin,this.angleMax,a||this.color())};this.contact=null;this.click=function(e){var a=typeof this.data.click=='function'?this.data.click:(B.click||null);if(a){a(this.data,e)}};if(B.tip.show&&typeof B.tip.content=='function'){this.tip=null;this.showTip=function(){if(this.tip){this.tip.style.display='inline'}else{var a=(this.angleMin+this.angleMax)/2;var b=J.centerX+this.radius*0.5*Math.cos(a);var c=J.centerY+this.radius*0.5*Math.sin(a);this.tip=A._createTip(B.tip.content(this.data),b,c);var d=this;d.tip.onclick=function(e){d.click(e)}}};this.hideTip=function(){if(this.tip){this.tip.style.display='none'}}}};var T=function(j,k,l,m,n,o,p,q){this.content=j;this.length=k;this.width=l;this.height=m;this.floatright=n;this.floattop=o;this.endX=function(){return this.left+(this.floatright?0:this.width)};this.endY=function(){return this.top+this.height/2};this.data=p;this.contact=q;this.color=function(){return this.contact.color()};this.index=function(){return this.contact.index};this.resetposition=function(){var a=this.length;var b=J.centerX;var c=J.centerY;var d=(this.contact.angleMin+this.contact.angleMax)/2;var e=Math.cos(d);var f=Math.sin(d);var g=1.1;var h=e>0?1+e:0;var i=f>0?f:0;this.startX=b+this.contact.radius*e;this.startY=c+this.contact.radius*f;this.left=b+M*g*e+(this.floatright?0:-this.width);this.top=c+M*g*f+i*a-a-Q}};var U=function(a){return(a-I.minvalue)/(I.maxvalue-I.minvalue)};var V=function(a,b,c,d,e,f){var g=(b+c)/2;var h=J.centerX;var i=J.centerY;var j=Math.cos(g);var k=Math.sin(g);O.save();O.beginPath();O.arc(h,i,M*a,b,c);O.lineTo(h,i);O.closePath();O.fillStyle=d;O.fill();if(B.separeateLine.show){O.lineWidth=B.separeateLine.width||1;O.strokeStyle=B.separeateLine.color||B.lineColor||'#ffffff';O.stroke()}O.restore();var l=B.outerLabel;if(e&&l.show&&typeof l.content=='function'){var m=l.length||M/12;O.save();var n=DChart.Methods.JudgeBetweenAngle(-Math.PI*0.5,Math.PI*0.5,g);var o=DChart.Methods.JudgeBetweenAngle(-Math.PI,0,g);var p=l.content(e);O.textAlign=n?'left':'right';O.font=(l.fontsize||(m-1))+'px '+(l.fontfamily||B.fontFamily||DChart.Const.Defaults.FontFamily);var q=O.measureText(p).width;O.restore();var r=q+(l.withlegend?m+3*P:2*P);var s=m+Q*2;var t=new T(p,m,r,s,n?1:0,o?1:0,e,f);A.shapes.outerLabels.push(t);f.contact=t}};var W=function(g){var h=B.scale;var j=h.linewidth;if(!(h.linewidth>0)){return}var i=0;for(var k=I.minvalue+I.interval;k<=I.maxvalue;k+=I.interval){var l=h.linecolors&&h.linecolors.length>0?h.linecolors[i%h.linecolors.length]:'rgb(190,190,190)';A.DrawFigures.createArc(J.centerX,J.centerY,M*U(k),j,l);i++}var m=B.staff;var n=m.content;if(!m.show||typeof n!='function'||!(m.directions.length>0)){return}var o=m.fontsize||M/I.scalecount*0.6;var p=m.backcolor;var q=0;if(p){for(var k=I.minvalue+I.interval;k<=I.maxvalue;k+=I.interval){var r=A.DrawFigures.measureText(n(k),m.fontweight,o,m.fontfamily);q=Math.max(q,r)}}i=0;var s=function(a,b,c){var d=(b=='n'||b=='s')?J.centerX:(b=='w'?J.centerX-c:J.centerX+c);var e=(b=='w'||b=='e')?J.centerY+o/2.5:(b=='n'?J.centerY-c+o/2.5:J.centerY+c+o/2.5);if(p){A.DrawFigures.createRectangleFill(d-q/2-1,e-o+1,q+2,o+2,p)}var f=A.DrawFigures.createText(a,d,e,'center',m.fontweight,o,m.fontfamily,t);if(g){A.coordinates.polar.staff.push({direction:b,text:a,left:d-f/2,right:d+f/2,top:e-o,bottom:e,size:o,length:f})}};for(var k=I.minvalue+I.interval;k<=I.maxvalue;k+=I.interval){var t=m.fontcolor||'#000000';var u=M*U(k);var v=n(k);if(m.directions.__contains('n')){s(v,'n',u)}if(m.directions.__contains('s')){s(v,'s',u)}if(m.directions.__contains('e')){s(v,'e',u)}if(m.directions.__contains('w')){s(v,'w',u)}i++}};var X=function(l,m){var n=B.outerLabel;if(!(n.show&&typeof n.content=='function')){return}if(R){for(var i=0,shape;shape=A.shapes.outerLabels[i];i++){shape.resetposition()}R=false}var o=function(){var c=function(a,b){return Math.max(a.left,b.left)<=Math.min(a.left+a.width,b.left+b.width)&&Math.max(a.top,b.top)<=Math.min(a.top+a.height,b.top+b.height)};var d=[];var e=[];var f=[];var g=[];for(var i=0,shape;shape=A.shapes.outerLabels[i];i++){while(J.minY>shape.top){shape.top+=Q;shape.left+=shape.floatright?P:-P}while(J.maxY<shape.top+shape.height){shape.top-=Q;shape.left+=shape.floatright?P:-P}if(shape.floatright&&shape.floattop){f.push(shape)}else if(shape.floatright&&!shape.floattop){g.push(shape)}else if(!shape.floatright&&shape.floattop){d.push(shape)}else{e.push(shape)}}var h=0;var j=[];var k=function(r){if(j.length>0){for(var i=0,compare;compare=j[i];i++){while(c(compare,r)&&h<1000){r.top+=r.floattop?Q:-Q;r.left+=r.floatright?P:-P;h++}}}j.push(r)};for(var i=d.length-1;i>=0;i--){k(d[i])}j=[];for(var i=0;i<e.length;i++){k(e[i])}j=[];for(var i=0;i<f.length;i++){k(f[i])}j=[];for(var i=g.length-1;i>=0;i--){k(g[i])}};var p=function(a,b){var c=a;if(!b){A.DrawFigures.createQuadraticCurve(c.startX,c.startY,c.startX*0.8+c.endX()*0.2,c.startY*0.2+c.endY()*0.8,c.endX(),c.endY(),1,n.bordercolor);if(n.backcolor){A.DrawFigures.createRectangleFill(c.left,c.top,c.width,c.height,n.backcolor)}var d=c.left+(c.floatright?P+(n.withlegend?c.length+P:0):c.width-P);var e=c.top+c.length+Q/2;A.DrawFigures.createText(c.content,d,e,c.floatright?'left':'right',null,n.fontsize||(c.length-1),n.fontfamily,n.color);if(n.borderwidth&&n.borderwidth>0){A.DrawFigures.createRectangleBorder(c.left,c.top,c.width,c.height,n.borderwidth,n.bordercolor)}}if(n.withlegend){var f=n.legendtype||'s';var b=b||c.color();A.DrawFigures.createPointElement(f,c.left+P,c.top+Q,c.length,b,f!='x',b,2,f=='x')}};if(l){p(l.contact,m)}else{o();A.coordinates.polar.outerlabels.length=0;for(var i=0,shape;shape=A.shapes.outerLabels[i];i++){p(shape);A.coordinates.polar.outerlabels[i]={index:shape.contact.index,left:shape.left,top:shape.top,width:shape.width,height:shape.height}}}};var Y=function(a,b){var c=Math.PI*(B.startAngle==null?-0.5:B.startAngle);var d=B.animation&&B.animateScale?a:1;var e=B.animation&&B.animateRotate?a:1;if(!B.scaleOverlay){W(b>=1)}for(var i=0,G;G=A.innerData[i];i++){var f=(G.value/F)*100;var g=e*Math.PI*2*(B.averageAngle?1/E:(f/100));var h=G.color||N[i%N.length];var j=d*U(G.value);if(b>=1){G.percent=f;G.index=i;var k=new S(i,c,c+g,G,M*j);A.shapes.cemicircles.push(k);V(j,c,c+g,h,G,k);A.coordinates.polar.cemicircles.push({index:i,percent:f,radius:j,angleMin:c,angleMax:c+g,color:h})}else{V(j,c,c+g,h)}c+=g}if(B.scaleOverlay){W(b>=1)}if(b>=1){X()}};var Z=function(){var j=function(x,y){var a=null;for(var i=0,shape;shape=A.shapes.cemicircles[i];i++){var b=(shape.angleMin+shape.angleMax)/2;var c=J.centerX;var d=J.centerY;var e=DChart.Methods.GetCurrentAngle(x,y,c,d);var f=(Math.pow(x-c,2)+Math.pow(y-d,2)<=Math.pow(shape.radius,2))&&DChart.Methods.JudgeBetweenAngle(shape.angleMin,shape.angleMax,e);var g=false;if(B.outerLabel&&B.outerLabel.show&&shape.contact){var h=shape.contact;if(x>=h.left&&x<=h.left+h.width&&y>=h.top&&y<=h.top+h.height){g=true}}if(f||g){a=shape;break}}return a};A.canvas.onclick=function(e){var e=window.event||e;var a=A._getMouseLoction(e);var b=j(a.X,a.Y);if(b){b.click(e)}};A.canvas.onmousemove=function(e){var e=window.event||e;var a=A._getMouseLoction(e);var b=j(a.X,a.Y);if(A.tempData.currentMouseShape!=b){var c=A.tempData.currentMouseShape;if(c){var d=typeof c.data.mouseleave=='function'?c.data.mouseleave:(B.mouseleave||null);if(d){d(c.data,e)}}A.tempData.currentMouseShape=b;A._clearDrawable(J);X();for(var i=0,c;c=A.shapes.cemicircles[i];i++){if(c.isHovered){c.isHovered=false;if(c.hideTip){c.hideTip()}}c.redraw(null,true)}if(b){b.isHovered=true;if(B.mouseoverChangeCursor){A.canvas.style.cursor='pointer'}var f=B.mouseoverTransparency;var g='rgba(255,255,255,'+(f>0&&f<1?f:0.2)+')';b.redraw(g,false);X(b,g);if(b.showTip){b.showTip()}var h=typeof b.data.mouseover=='function'?b.data.mouseover:(B.mouseover||null);if(h){h(b.data,e)}}else{if(B.mouseoverChangeCursor){A.canvas.style.cursor='auto'}}W(false)}}};A._startDrawAndAnimation(Y,Z)},_spreadSkin:function(a,b){var c=DChart.Const.Skins;if(c[a]&&c[a].Polar){var d=c[a].Polar;b.separeateLine={};b.outerLabel={};b.staff={};b.scale={};b.separeateLine.color=d.SepareateLineColor||null;b.outerLabel.color=d.OuterLabelColor||null;b.outerLabel.backcolor=d.OuterLabelBackColor||null;b.outerLabel.bordercolor=d.OuterLabelBorderColor||null;b.staff.fontcolor=d.StaffFontColor||null;b.staff.backcolor=d.StaffBackColor||null;b.scale.linecolors=d.ScaleLineColors||null}},_getCheckOptions:function(){return{__top:[['radius','n'],['margin','n'],['colors','ca'],['animateRotate','b'],['animateScale','b'],['startAngle','n'],['averageAngle','b']],separeateLine:[['show','b'],['color','c'],['width','n']],scale:[['minvalue','n'],['maxvalue','n'],['interval','n'],['linecolors','ca']],staff:[['show','b'],['content','f'],['fontcolor','c'],['fontfamily','s'],['fontsize','n'],['fontweight','s'],['directions','sa'],['backcolor','c']],outerLabel:[['show','b'],['content','f'],['withlegend','b'],['legendtype','s'],['length','n'],['color','c'],['backcolor','c'],['bordercolor','c'],['borderwidth','n'],['fontsize','n'],['fontfamily','s']]}}});