if(!window.DChart){throw new Error('未能加载dragonchart.core.js，该js必须在其他DChart框架的js加载之前被引用。\n'+'Not loaded dragonchart.core.js which must be loaded before other DChart\'s js.');}else{DChart.Const.Skins.BlackAndWhite.QueueBar={LabelColor:null}}DChart.QueueBar=DChart.getCore().__extends({GraphType:'QueueBar'});DChart.QueueBar._spreadSkin=function(a,b){a.label={};a.label.color=b.LabelColor||null};DChart.QueueBar._getDefaultOptions=function(b){var c=DChart.Methods.Extend(b,{animateY:true,animateX:true,splitpoint:null,contrastmode:true,bar:{colors:null,length:null,gap:null,useSameColor:true},label:{show:true,content:function(a){if(this.valueType=='d'){return a.value.format('MM-dd')}else if(this.valueType=='t'){return a.value.format('HH:mm')}else{return a.value.toString()}},color:null,fontweight:null,fontsize:null,fontfamily:null}});return c};DChart.QueueBar._getCheckOptions=function(){return{__top:[['animateY','b'],['animateX','b'],['contrastmode','b']],bar:[['colors','ca'],['length','n'],['gap','n'],['useSameColor','b']],label:[['show','b'],['content','f'],['color','c'],['fontweight','s'],['fontsize','n'],['fontfamily','s']]}};DChart.QueueBar._drawgraphic=function(s,t,u,v){if(v.valueType=='p'){throw new Error(s._messages.WrongParam+s._messages.ValueTypeMustNotBePercent);}var w=v.splitpoint;var z=w==null;if(t==s.ID){s._configs.computeSplitPoint=z;s._configs.invertAxis=true}var A=s._formatAxisData();if(z){w=A.splitpoint}else{A.splitpoint=w}if(A.demanCount>1&&(w>=A.vMaxval||w<=A.vMinval)){throw new Error(s._messages.WrongSet+s._messages.WrongSplitPoint);}var B=s._calculateOutersValid();var C=s._computeAxis(B);var D=(v.bar.colors&&v.bar.colors.length>0?v.bar.colors:null)||DChart.Const.Defaults.FillColors;var E=s._getDrawableCoordinate();if(t==s.ID){s.coordinates.draw=E;s._configs.legendColors=D}if(!s.coordinates.bars){s.coordinates.bars={}}s.coordinates.bars[t]=[];s.shapes[t]={bars:[]};var F=s._configs.specificConfig[t];var G=v.contrastmode;var H=G?Math.ceil(A.demanCount/2.0-0.1):A.demanCount;var I=v.bar.gap;var J=v.bar.length;var K=H>1;if(K){if(I&&I>0){var L=(C.labelDistance-H*2)/(H+1);I=Math.min(I,L)}else{I=C.labelDistance/20}}else{I=0}if(J&&J>0){var M=K?((C.labelDistance-(H+1)*I)/H):C.labelDistance*0.8;J=Math.min(J,M)}else{J=(C.labelDistance-(H+1)*I)/(K?(H+0.5):1.5)}var N=v.shadow.show;var O=function(a){var b=null;if(N){var c=Math.max(Math.abs(v.shadow.blur),Math.abs(v.shadow.offsetX));b=DChart.Methods.DeepCopy(v.shadow);b.offsetX=a?-c:c}return b};var P=function(a,b,c,d,e,f,g,h){s.DrawFigures.createRectangleFill(b,c,d,e,f,h||O(a));if(g&&v.label.show){var i=v.label;var j=typeof i.content=='function'?i.content.call(v,g):'';if(j){var k=i.fontsize||DChart.Methods.CapValue(e,18,11);var l=a?b-k/2:b+d+k/2;var m=c+e/2+k/3;s.DrawFigures.createText(j,l,m,a?'right':'left',g.fontweight||i.fontweight,g.fontsize||k,i.fontfamily,g.fontcolor||i.color)}}};var Q=function(d,f,g,h,i,j,k,l,m){this.isSmall=d;this.indexX=f;this.indexY=g;this.left=h;this.top=i;this.width=j;this.height=k;this.data=m;this.isHovered=false;this.color=l;this.redraw=function(a,b){if(arguments.length==1&&typeof arguments[0]=='boolean'){b=arguments[0];a=undefined}var c=O(this.isSmall);if(c&&a){c.color=a}P(this.isSmall,this.left,this.top,this.width,this.height,a||this.color,b?this.data:null,c)};this.click=function(e){var a=typeof this.data.click=='function'?this.data.click:(v.click||null);if(a){a(this.data,e)}};if(v.tip.show&&typeof v.tip.content=='function'){this.tip=null;this.showTip=function(){if(this.tip){this.tip.style.display='inline'}else{var a=this.left+this.width/2+5;var b=this.top+this.height/2;this.tip=s._createTip(v.tip.content.call(v,this.data),a,b);var c=this;c.tip.onclick=function(e){c.click(e)}}};this.hideTip=function(){if(this.tip){this.tip.style.display='none'}}}};var R=function(d,e){var f=function(a){var b=Math.abs(s._getFormatDiff(A.vValueType,w,a));var c=(v.animateX?d:1)*(C.maxX-C.minX)*b/s._getFormatDiff(A.vValueType,A.vMinValue,A.vMaxValue);return c};for(var i=0,item;item=u[i];i++){var g=(v.animateY?d:1)*J;if(A.multiple){var h=item.color||D[i%D.length];var j=H/2-(G?parseInt(i/2):i);for(var k=0;k<item.value.length;k++){var l=item.value[k];var m=l<w;var n=C.startPos-C.labelDistance*k-j*J-(j-0.5)*I;var o=f(l);var p=m?C.splitLinePos-o:C.splitLinePos;if(e>=1){var q={text:item.text,value:l,indexX:k,indexY:i,fontsize:item.fontsize,fontcolor:item.fontcolor,fontweight:item.fontweight,click:item.click,mouseover:item.mouseover,mouseleave:item.mouseleave};var r=new Q(m,k,i,p,n,o,g,h,q);s.shapes[t].bars.push(r);P(m,p,n,o,g,h,q);if(!s.coordinates.bars[t][k]){s.coordinates.bars[t][k]=[]}s.coordinates.bars[t][k][i]={left:p,top:n,width:o,height:g,color:h}}else{P(m,p,n,o,g,h)}}}else{var l=item.value;var m=l<w;var o=f(l);var p=m?C.splitLinePos-o:C.splitLinePos;var n=C.startPos-C.labelDistance*i-J/2;var h=item.color||(v.bar.useSameColor?'rgba(69,114,167,1)':D[i%D.length]);if(e>=1){var q={text:item.text,value:l,indexX:i,indexY:null,fontsize:item.fontsize,fontcolor:item.fontcolor,fontweight:item.fontweight,click:item.click,mouseover:item.mouseover,mouseleave:item.mouseleave};var r=new Q(m,i,null,p,n,o,g,h,q);s.shapes[t].bars.push(r);P(m,p,n,o,g,h,q);s.coordinates.bars[t][i]={left:p,top:n,width:o,height:g,color:h}}else{P(m,p,n,o,g,h)}}}};var S=function(){var h=function(x,y){var a=null;for(var i=0,shape;shape=s.shapes[t].bars[i];i++){if(shape.left<=x&&shape.left+shape.width>=x&&shape.top<=y&&shape.top+shape.height>=y){a=shape;break}}return a};var j=function(e){var e=window.event||e;var a=s._getMouseLoction(e);var b=h(a.X,a.Y);if(b){b.click(e)}};var k=function(e){var e=window.event||e;var a=s._getMouseLoction(e);var b=h(a.X,a.Y);if(b){s._configs.cursorPointer=true}if(F.currentMouseShape!=b){var c=F.currentMouseShape;if(c){var d=typeof c.data.mouseleave=='function'?c.data.mouseleave:(v.mouseleave||null);if(d){d(c.data,e)}}if(N||F.currentMouseShape){s.redrawAll()}F.currentMouseShape=b;for(var i=0,c;c=s.shapes[t].bars[i];i++){if(c!=b&&c.isHovered){c.isHovered=false;if(c.hideTip){c.hideTip()}}}if(b){b.isHovered=true;var f=v.mouseoverTransparency;b.redraw('rgba(255,255,255,'+(f>0&&f<1?f:0.2)+')');if(b.showTip){b.showTip()}var g=typeof b.data.mouseover=='function'?b.data.mouseover:(v.mouseover||null);if(g){g(b.data,e)}}}};s._addEventListener('click',j);s._addEventListener('mousemove',k)};var T=function(){for(var i=0,shape;shape=s.shapes[t].bars[i];i++){shape.redraw(true)}};return{drawSegments:R,mouseEvents:S,redraw:T}};