Date.prototype.format=function(a){var o={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),"S":this.getMilliseconds()};if(/(y+)/.test(a)){a=a.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))}for(var k in o){if(new RegExp("("+k+")").test(a)){a=a.replace(RegExp.$1,(RegExp.$1.length==1)?(o[k]):(("00"+o[k]).substr((""+o[k]).length)))}}return a};dcharttools.clock=function(F){var G=this;G.parentDivID=F;G._initial=function(){var a=document.getElementById(G.parentDivID);if(a!=null&&a.nodeName.toLowerCase()=='div'){G.parentDiv=a}else{throw new Error("The parent element doesn't exist or isn't a div!");}G.parentDiv.innerHTML="";var b=document.createElement('canvas');G.ID='DChart_'+Math.random().toString().substring(5);b.setAttribute('id',G.ID);b.width=G.parentDiv.clientWidth;b.height=G.parentDiv.clientHeight;if(!!window.ActiveXObject&&!document.createElement('canvas').getContext){if(window.G_vmlCanvasManager){b=window.G_vmlCanvasManager.initElement(b)}else{throw new Error("please include excanvas.js!");}}G.parentDiv.appendChild(b);G.canvas=b;G.ctx=b.getContext('2d');G._configs={};G._configs._adjust=0;G._configs._runningHandler=null;G._configs._currentVal=null;G._configs._computed=null;G.options=G._getDefaultOptions()};G._getDefaultOptions=function(){var b={centerX:null,centerY:null,radius:null,tickType:'fluent',adjust:0,canvas:{backcolor:null,borderwidth:1,bordercolor:null},background:{backcolor:null,borderwidth:1,bordercolor:null,shadowcolor:'#000000',shadowblur:0},calibration:{backcolor:null,margin:null,interval:4,thinwidth:2,thickwidth:4,thinlength:null,thicklength:null,thinlinecolor:'#999999',thicklinecolor:'#000000'},labels:{margin:null,labels:['1','2','3','4','5','6','7','8','9','10','11','12'],labelcontrol:'111111111111',rotate:false,fontcolor:null,fontsize:null,fontfamily:null,fontweight:'bold'},pointer:{nodecolor:null,nodelength:null,hourpincolor:null,hourheadwidth:null,hourtailwidth:null,hourpinlength:null,minutepincolor:null,minuteheadwidth:null,minutetailwidth:null,minutepinlength:null,secondpincolor:'#a01313',secondheadwidth:null,secondtailwidth:null,secondpinlength:null},currentValue:{show:true,content:function(a){return a.format("hh:mm:ss")},xdistance:null,ydistance:null,fontcolor:null,fontsize:null,fontfamily:null,fontweight:null,backcolor:null,borderwidth:0,bordercolor:null}};return b};G._computeOptions=function(a){if(!a&&G._configs._computed){return G._configs._computed}var b=G.options;var c=b.centerX||G.canvas.width/2;var d=b.centerY||G.canvas.height/2;var e=b.radius||Math.min(G.canvas.width,G.canvas.height)*0.4;var f=b.calibration.margin||e/12;var g=b.calibration.thinlength||e/15;var h=b.calibration.thicklength||g*1.2;var i=e-f;var j=e-f-g;var k=e-f-h;var l={margin:f,thinlength:g,thicklength:h,outerRadius:i,thinInnerRadius:j,thickInnerRadius:k};var m=b.labels.margin||e/15;var n=b.labels.fontsize||e/5;var o=k-m;var p={margin:m,radius:o,fontsize:n};var q=b.pointer.nodelength||e/12;var r=b.pointer.hourtailwidth||e/14;var s=b.pointer.hourheadwidth||e/40;var t=b.pointer.hourpinlength||e*0.5;var u=b.pointer.minutetailwidth||e/25;var v=b.pointer.minuteheadwidth||e/40;var w=b.pointer.minutepinlength||e*0.8;var x=b.pointer.secondtailwidth||e/40;var y=b.pointer.secondheadwidth||0;var z=b.pointer.secondpinlength||e;if(t>=e+q||w>=e+q||z>=e+q){throw new Error("pinlength should be less than radius!");}var A={nodelength:q,hour:{tailwidth:r,headwidth:s,pinlength:t,pincolor:b.pointer.hourpincolor},minute:{tailwidth:u,headwidth:v,pinlength:w,pincolor:b.pointer.minutepincolor},second:{tailwidth:x,headwidth:y,pinlength:z,pincolor:b.pointer.secondpincolor}};var B=b.currentValue.xdistance||0;var C=b.currentValue.ydistance==null?0.4:b.currentValue.ydistance;var D=b.currentValue.fontsize||e/8;var E={xdistance:B,ydistance:C,fontsize:D};G._configs._computed={centerX:c,centerY:d,radius:e,calibration:l,labels:p,pointer:A,currentValue:E};return G._configs._computed};G._drawCanvasBackround=function(){var a=G.options.canvas;if(a.backcolor){dcharttools.createRect(G.ctx,0,0,G.canvas.width,G.canvas.height,a.backcolor)}else{G.ctx.clearRect(0,0,G.canvas.width,G.canvas.height)}var b=a.borderwidth||0;if(b>0){dcharttools.createRect(G.ctx,0,0,G.canvas.width,G.canvas.height,null,b*2,a.bordercolor)}};G._drawBackground=function(){var a=G._computeOptions();var b=G.options.background;var c=null;if(b.shadowblur>0){c={color:b.shadowcolor||'#000000',blur:b.shadowblur}}dcharttools.createArc(G.ctx,a.centerX,a.centerY,a.radius,0,null,b.backcolor||'#F2F2F2',null,null,c);dcharttools.createArc(G.ctx,a.centerX,a.centerY,a.radius,b.borderwidth,b.bordercolor)};G._drawCalibration=function(){var a=G._computeOptions();var b=a.calibration;var c=a.labels;var d=G.options.calibration;var e=G.options.labels;if(d.backcolor){dcharttools.createRing(G.ctx,a.centerX,a.centerY,b.thinInnerRadius,b.outerRadius,d.backcolor,0,Math.PI*2)}var f=Math.PI*2/12;var g=d.interval>0?f/(d.interval+1):null;var h=[0,0.2,0.3,0.3,0.3,0.2,0,-0.25,-0.4,-0.3,-0.25,-0.25];var k=[0.5,0.4,0.4,0.3,0.2,0.1,0.1,0.15,0.2,0.3,0.4,0.45];for(var i=0;i<12;i++){var l=f*i;var m=Math.sin(l);var n=Math.cos(l);var o=a.centerX+b.thickInnerRadius*m;var p=a.centerY-b.thickInnerRadius*n;var q=a.centerX+b.outerRadius*m;var r=a.centerY-b.outerRadius*n;dcharttools.createLine(G.ctx,o,p,q,r,d.thickwidth,d.thicklinecolor);if(e.labelcontrol[(i+11)%12]=="1"){var s=e.labels[(i+11)%e.labels.length];if(e.rotate){var t=a.centerX+(c.radius-c.fontsize/2)*m;var u=a.centerY-(c.radius-c.fontsize/2)*n;dcharttools.createText(G.ctx,s,t,u,'center',e.fontweight,c.fontsize,e.fontfamily,e.fontcolor,l)}else{var v=dcharttools.measureText(G.ctx,s,e.fontweight,c.fontsize,e.fontfamily);var w=-v*h[i];var x=k[i]*1.3*c.fontsize;var t=a.centerX+c.radius*m+w;var u=a.centerY-c.radius*n+x;dcharttools.createText(G.ctx,s,t,u,'center',e.fontweight,c.fontsize,e.fontfamily,e.fontcolor)}}if(d.interval>0){for(var j=1;j<=d.interval;j++){var y=l+g*j;m=Math.sin(y);n=Math.cos(y);o=a.centerX+b.thinInnerRadius*m;p=a.centerY-b.thinInnerRadius*n;q=a.centerX+b.outerRadius*m;r=a.centerY-b.outerRadius*n;dcharttools.createLine(G.ctx,o,p,q,r,d.thinwidth,d.thinlinecolor)}}}};G._drawPointer=function(){var r=G._computeOptions();var s=G.options.pointer;var t=G._configs._currentVal;var u=t.getTime();var v=Date.parse(t.format("yyyy/MM/dd "+(t.getHours()>11?"12":"00")+":00:00"));var w=Math.PI*2*(u-v)/43200000;var x=Math.PI*2*(u-Date.parse(t.format("yyyy/MM/dd "+t.getHours()+":00:00")))/3600000;var y=Math.PI*2*(u-Date.parse(t.format("yyyy/MM/dd "+t.getHours()+":"+t.getMinutes()+":00")))/60000;var z=function(a,b){var c=Math.sin(a);var d=Math.cos(a);var e=r.centerX+b.pinlength*0.8*c;var f=r.centerY-b.pinlength*0.8*d;var g=e-b.headwidth/2*d;var h=f-b.headwidth/2*c;var i=e+b.headwidth/2*d;var j=f+b.headwidth/2*c;var k=r.centerX-b.pinlength*0.2*c;var l=r.centerY+b.pinlength*0.2*d;var m=k-b.tailwidth/2*d;var n=l-b.tailwidth/2*c;var o=k+b.tailwidth/2*d;var p=l+b.tailwidth/2*c;var q=[[g,h],[i,j],[o,p],[m,n]];dcharttools.createCloseFigure(G.ctx,q,b.pincolor||'#000000')};z(w,r.pointer.hour);z(x,r.pointer.minute);z(y,r.pointer.second);dcharttools.createArc(G.ctx,r.centerX,r.centerY,r.pointer.nodelength/2,0,null,s.nodecolor||s.secondpincolor||'#000000')};G._drawCurrentValue=function(){var a=G.options.currentValue;if(!G._configs._currentVal||!a.show||typeof a.content!='function'){return}var b=G._configs._currentVal;var c=G._computeOptions();var d=a.content(b);var e=c.centerX-c.radius*c.currentValue.xdistance;var f=c.centerY-c.radius*c.currentValue.ydistance+c.currentValue.fontsize/3;if(a.backcolor||a.borderwidth){var g=dcharttools.measureText(G.ctx,d,a.fontweight,c.currentValue.fontsize,a.fontfamily);var h=e-g/2-c.currentValue.fontsize/4;var i=f-c.currentValue.fontsize;dcharttools.createRect(G.ctx,h,i,g+c.currentValue.fontsize/2,c.currentValue.fontsize*4/3,a.backcolor,a.borderwidth,a.bordercolor)}dcharttools.createText(G.ctx,d,e,f,'center',a.fontweight,c.currentValue.fontsize,a.fontfamily,a.fontcolor)};G._drawValue=function(){G._drawCanvasBackround();G._drawBackground();G._drawCalibration();G._drawPointer();G._drawCurrentValue()};G.setOptions=function(a){G.options=dcharttools.funcs._override(G.options,a)};G.setAdjust=function(a){G._configs._adjust=a||0};G.draw=function(){G._computeOptions(true);if(G._configs._runningHandler){clearInterval(G._configs._runningHandler)}G._configs._adjust=G.options.adjust||0;if(G.options.tickType=="fluent"){G._configs._runningHandler=setInterval(function(){G._configs._currentVal=new Date((new Date).getTime()+G._configs._adjust);G._drawValue()},10)}else if(G.options.tickType=="vibrate"){G._configs._runningHandler=setInterval(function(){var a=(new Date).getTime()+G._configs._adjust;G._configs._currentVal=new Date(a);if(a-Date.parse(G._configs._currentVal.format("yyyy/MM/dd hh:mm:ss"))<=30){G._drawValue()}},10)}};G._initial();return G}