if(!window.DChart){throw new Error('未能加载dragonchart.core.js，该js必须在其他DChart框架的js加载之前被引用。\n'+'Not loaded dragonchart.core.js which must be loaded before other DChart\'s js.');}else{DChart.Const.Skins.BlackAndWhite.QueueHistogram3D={LabelColor:null}}DChart.QueueHistogram3D=DChart.getCore().__extends({GraphType:'QueueHistogram3D'});DChart.QueueHistogram3D._spreadSkin=function(a,b){a.label={};a.label.color=b.LabelColor||null};DChart.QueueHistogram3D._getDefaultOptions=function(b){var c=DChart.Methods.Extend(b,{animateY:true,animateX:true,splitpoint:null,contrastmode:true,histogram:{colors:null,length:null,gap:null},label:{show:true,content:function(a){if(this.valueType=='d'){return a.value.format('MM-dd')}else if(this.valueType=='t'){return a.value.format('HH:mm')}else{return a.value.toString()}},color:null,fontweight:null,fontsize:null,fontfamily:null}});return c};DChart.QueueHistogram3D._getCheckOptions=function(){return{__top:[['animateY','b'],['animateX','b'],['contrastmode','b']],histogram:[['colors','ca'],['length','n'],['gap','n']],label:[['show','b'],['content','f'],['color','c'],['fontweight','s'],['fontsize','n'],['fontfamily','s']]}};DChart.QueueHistogram3D._drawgraphic=function(u,v,w,z){if(!w[0].value.length||w[0].value.length<=1){throw new Error(u._messages.WrongData+u._messages.DataMustBeMultipleArray);}if(z.valueType=='p'){throw new Error(u._messages.WrongParam+u._messages.ValueTypeMustNotBePercent);}u._configs.recreateAssists=true;var A=z.splitpoint;var B=A==null;if(v==u.ID){u._configs.computeSplitPoint=B}var C=u._formatAxisData();if(B){A=C.splitpoint}else{C.splitpoint=A}if(w.length>1&&(A>=C.vMaxval||A<=C.vMinval)){throw new Error(u._messages.WrongSet+u._messages.WrongSplitPoint);}var D=u._calculateOutersValid();var E=u._computeAxis(D);var F=(z.histogram.colors&&z.histogram.colors.length>0?z.histogram.colors:null)||DChart.Const.Defaults.FillColors;var G=u._getDrawableCoordinate();if(v==u.ID){u.coordinates.draw=G;u._configs.legendColors=F}if(!u.coordinates.histograms){u.coordinates.histograms={}}u.coordinates.histograms[v]=[];u.shapes[v]={histograms:[]};var H=u._configs.specificConfig[v];var I=z.contrastmode;var J=I?Math.ceil(C.demanCount/2.0-0.1):C.demanCount;var K=z.histogram.gap;var L=z.histogram.length;var M=J>1;if(M){if(K&&K>0){var N=(E.labelDistance-J*2)/(J+1);K=Math.min(K,N)}else{K=E.labelDistance/20}}else{K=0}if(L&&L>0){var O=M?((E.labelDistance-(J+1)*K)/J):E.labelDistance*0.8;L=Math.min(L,O)}else{L=(E.labelDistance-(J+1)*K)/(M?(J+0.5):1.5)}var P=function(){var a=z.splitLine.linewidth;if(z.splitLine.show&&a&&a>0){var b=z.splitLine.linecolor||'#cccccc';var c=E.stagewidth;var d=E.minX-c*E.sinsightangle;var e=E.splitLinePos+c*E.cossightangle;u.DrawFigures.create3DHistogram(d,e,E.maxX-E.minX,a,b,0,E.sightangle,c,null,DChart.Methods.getDarkenColor(b,0.7),DChart.Methods.getDarkenColor(b,0.8))}};var Q=function(a,b,c,d,e){var f=a.left-E.stagewidth*E.sinsightangle;var g=a.top+E.stagewidth*E.cossightangle;var h=b||a.color;if(d){u.DrawFigures.create3DHistogram(f,g,a.width,a.height,h,0,E.sightangle,E.stagewidth,null,c?b:a.topcolor||DChart.Methods.getDarkenColor(h,0.7),c?b:a.rightcolor||DChart.Methods.getDarkenColor(h,0.8))}if(e&&z.label.show){var i=z.label;var j=typeof i.content=='function'?i.content.call(z,a.data):'';if(j){var k=(a.left+f)/2+a.width/2;var l=i.fontsize||DChart.Methods.CapValue(a.width/2,18,11);var m=a.isSmall?g+a.height+l:a.top-l/3;u.DrawFigures.createText(j,k,m,'center',a.data.fontweight||i.fontweight,a.data.fontsize||l,i.fontfamily,a.data.fontcolor||i.color)}}};var R=function(f,g,h,i,j,k,l,m,n,o,p){this.isSmall=f;this.indexX=g;this.indexY=h;this.left=i;this.top=j;this.width=k;this.height=l;this.data=p;this.isHovered=false;this.color=m;this.topcolor=n;this.rightcolor=o;this.redraw=function(a,b,c,d){Q(this,d,a,b,c)};this.click=function(e){var a=typeof this.data.click=='function'?this.data.click:(z.click||null);if(a){a(this.data,e)}};if(z.tip.show&&typeof z.tip.content=='function'){this.tip=null;this.showTip=function(){if(this.tip){this.tip.style.display='inline'}else{var a=this.left;var b=this.top+this.height/2;this.tip=u._createTip(z.tip.content.call(z,this.data),a,b);if(a+this.tip.clientWidth>E.maxX){u._changeTip(this.tip,a-this.width/2-this.tip.clientWidth)}var c=this;c.tip.onclick=function(e){c.click(e)}}};this.hideTip=function(){if(this.tip){this.tip.style.display='none'}}}};var S=function(d,e){var f=function(a){var b=Math.abs(u._getFormatDiff(C.vValueType,A,a));var c=(z.animateY?d:1)*(E.maxY-E.minY)*b/u._getFormatDiff(C.vValueType,C.vMinValue,C.vMaxValue);return c};var g=e>=1;var h=[];for(var i=0,item;item=w[i];i++){var j=(z.animateX?d:1)*L;var l=item.color||F[i%F.length];for(var k=0;k<item.value.length;k++){var m=item.value[k];var n=m<A;var o=J/2-(I?parseInt(i/2):i);var p=E.startPos+E.labelDistance*k-o*L-(o-0.5)*K;var q=f(m);var r=n?E.splitLinePos:E.splitLinePos-q;var s=null;if(g){s={text:item.text,value:m,indexX:i,indexY:k,fontsize:item.fontsize,fontcolor:item.fontcolor,fontweight:item.fontweight,click:item.click,mouseover:item.mouseover,mouseleave:item.mouseleave};if(!u.coordinates.histograms[v][k]){u.coordinates.histograms[v][k]=[]}u.coordinates.histograms[v][k][i]={left:p,top:r,width:j,height:q,color:l}}var t=new R(n,i,k,p,r,j,q,l,item.topcolor,item.rightcolor,s);h.push(t)}}for(var i=0,t;t=h[i];i++){if(t.isSmall){Q(t,t.color,false,true)}}P();for(var i=0,t;t=h[i];i++){if(!t.isSmall){Q(t,t.color,false,true)}}if(g){for(var i=0,t;t=h[i];i++){Q(t,t.color,false,false,true)}u.shapes[v].histograms=h}};var T=function(){var h=function(x,y){var a=null;var b=E.cossightangle*E.stagewidth;var c=E.sinsightangle*E.stagewidth;for(var i=0,shape;shape=u.shapes[v].histograms[i];i++){var d=shape.left-E.stagewidth*E.sinsightangle;var e=shape.top+E.stagewidth*E.cossightangle;if(d<=x&&d+shape.width>=x&&e<=y&&e+shape.height>=y){a=shape;break}}if(!a){for(var i=0,shape;shape=u.shapes[v].histograms[i];i++){if(shape.left+shape.width-c<=x&&shape.left+shape.width>=x){var f=shape.top+b*(shape.left+shape.width-x)/c;if(f<=y&&f+shape.height>=y){a=shape;break}}}}if(!a){for(var i=0,shape;shape=u.shapes[v].histograms[i];i++){if(shape.top<=y&&shape.top+b>=y){var g=shape.left-c*(y-shape.top)/b;if(g<=x&&g+shape.width>=x){a=shape;break}}}}return a};var j=function(e){var e=window.event||e;var a=u._getMouseLoction(e);var b=h(a.X,a.Y);if(b){b.click(e)}};var k=function(e){var e=window.event||e;var a=u._getMouseLoction(e);var b=h(a.X,a.Y);if(b){u._configs.cursorPointer=true}if(H.currentMouseShape!=b){var c=H.currentMouseShape;if(c){var d=typeof c.data.mouseleave=='function'?c.data.mouseleave:(z.mouseleave||null);if(d){d(c.data,e)}}if(H.currentMouseShape){u.redrawAll()}H.currentMouseShape=b;for(var i=0,c;c=u.shapes[v].histograms[i];i++){if(c!=b&&c.isHovered){c.isHovered=false;if(c.hideTip){c.hideTip()}}}if(b){b.isHovered=true;var f=z.mouseoverTransparency;b.redraw(true,true,false,'rgba(255,255,255,'+(f>0&&f<1?f:0.2)+')');if(b.showTip){b.showTip()}var g=typeof b.data.mouseover=='function'?b.data.mouseover:(z.mouseover||null);if(g){g(b.data,e)}}}};u._addEventListener('click',j);u._addEventListener('mousemove',k)};var U=function(){for(var i=0,shape;shape=u.shapes[v].histograms[i];i++){if(shape.isSmall){shape.redraw(false,true)}}P();for(var i=0,shape;shape=u.shapes[v].histograms[i];i++){if(!shape.isSmall){shape.redraw(false,true)}}for(var i=0,shape;shape=u.shapes[v].histograms[i];i++){shape.redraw(false,false,true)}};return{drawSegments:S,mouseEvents:T,redraw:U}};