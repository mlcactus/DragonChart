if(!window.DChart){throw new Error('未能加载dragonchart.core.js，该js必须在其他DChart框架的js加载之前被引用。\n'+'Not loaded dragonchart.core.js which must be loaded before other DChart\'s js.');}else{DChart.Const.Skins.BlackAndWhite.QueueHistogram={LabelColor:null}}DChart.QueueHistogram=DChart.getCore().__extends({GraphType:'QueueHistogram'});DChart.QueueHistogram._spreadSkin=function(a,b){a.label={};a.label.color=b.LabelColor||null};DChart.QueueHistogram._getDefaultOptions=function(b){var c=DChart.Methods.Extend(b,{animateY:true,animateX:true,splitpoint:null,contrastmode:true,histogram:{colors:null,length:null,gap:null,useSameColor:true},label:{show:true,content:function(a){if(this.valueType=='d'){return a.value.format('MM-dd')}else if(this.valueType=='t'){return a.value.format('hh:mm')}else if(this.valueType=='m'){return a.value.format('mm:ss.S')}else{return a.value.toString()}},color:null,fontweight:null,fontsize:null,fontfamily:null}});return c};DChart.QueueHistogram._getCheckOptions=function(){return{__top:[['animateY','b'],['animateX','b'],['contrastmode','b']],histogram:[['colors','ca'],['length','n'],['gap','n'],['useSameColor','b']],label:[['show','b'],['content','f'],['color','c'],['fontweight','s'],['fontsize','n'],['fontfamily','s']]}};DChart.QueueHistogram._drawgraphic=function(r,s,t,u){if(u.valueType=='p'){throw new Error(r._messages.WrongParam+r._messages.ValueTypeMustNotBePercent);}var v=u.splitpoint;var w=v==null;if(s==r.ID){r._configs.computeSplitPoint=w}var z=r._formatAxisData();if(w){v=z.splitpoint}else{z.splitpoint=v}if(z.demanCount>1&&(v>=z.vMaxval||v<=z.vMinval)){throw new Error(r._messages.WrongSet+r._messages.WrongSplitPoint);}var A=r._calculateOutersValid();var B=r._computeAxis(A);var C=(u.histogram.colors&&u.histogram.colors.length>0?u.histogram.colors:null)||DChart.Const.Defaults.FillColors;var D=r._getDrawableCoordinate();if(!r.coordinates.histograms){r.coordinates.histograms={}}r.coordinates.histograms[s]=[];r.shapes[s]={histograms:[]};var E=r._configs.specificConfig[s];var F=u.contrastmode;var G=F?Math.ceil(z.demanCount/2.0-0.1):z.demanCount;var H=u.histogram.gap;var I=u.histogram.length;var J=G>1;if(J){if(H&&H>0){var K=(B.labelDistance-G*2)/(G+1);H=Math.min(H,K)}else{H=B.labelDistance/20}}else{H=0}if(I&&I>0){var L=J?((B.labelDistance-(G+1)*H)/G):B.labelDistance*0.8;I=Math.min(I,L)}else{I=(B.labelDistance-(G+1)*H)/(J?(G+0.5):1.5)}var M=u.shadow.show;var N=function(a){var b=null;if(M){var c=Math.max(Math.abs(u.shadow.blur),Math.abs(u.shadow.offsetY));b=DChart.Methods.DeepCopy(u.shadow);b.offsetY=a?c:-c}return b};var O=function(i,k){if(k!=undefined){var a=G/2-(F?parseInt(i/2):i);return B.startPos+B.labelDistance*k-a*I-(a-0.5)*H}else{return B.startPos+B.labelDistance*i-I/2}};if(s==r.ID){r.coordinates.draw=D;r._configs.legendColors=C;if(z.multiple){r._configs.pointsPosition={labelDistance:B.labelDistance,startPoints:[]};for(var i=0,item;item=t[i];i++){r._configs.pointsPosition[i]=O(i,0)+I/2}}}var P=function(a,b,c,d,e,f,g,h){r.DrawFigures.createRectangleFill(b,c,d,e,f,h||N(a));if(g&&u.label.show){var i=u.label;var j=typeof i.content=='function'?i.content.call(u,g):'';if(j){var k=b+d/2;var l=i.fontsize||DChart.Methods.CapValue(d/2,18,11);var m=a?c+e+l:c-l/3;r.DrawFigures.createText(j,k,m,'center',g.fontweight||i.fontweight,g.fontsize||l,i.fontfamily,g.fontcolor||i.color)}}};var Q=function(d,f,g,h,i,j,k,l,m){this.isSmall=d;this.indexX=f;this.indexY=g;this.left=h;this.top=i;this.width=j;this.height=k;this.data=m;this.isHovered=false;this.color=l;this.redraw=function(a,b){if(arguments.length==1&&typeof arguments[0]=='boolean'){b=arguments[0];a=undefined}var c=N(this.isSmall);if(c&&a){c.color=a}P(this.isSmall,this.left,this.top,this.width,this.height,a||this.color,b?this.data:null,c)};this.click=function(e){var a=typeof this.data.click=='function'?this.data.click:(u.click||null);if(a){a(this.data,e)}};if(u.tip.show&&typeof u.tip.content=='function'){this.tip=null;this.showTip=function(){if(this.tip){this.tip.style.display='inline'}else{var a=this.left+this.width/2+5;var b=this.top+this.height/2;this.tip=r._createTip(u.tip.content.call(u,this.data),a,b);if(a+this.tip.clientWidth>B.maxX){r._changeTip(this.tip,a-this.width/2-this.tip.clientWidth)}var c=this;c.tip.onclick=function(e){c.click(e)}}};this.hideTip=function(){if(this.tip){this.tip.style.display='none'}}}};var R=function(d,e){var f=function(a){var b=Math.abs(r._getFormatDiff(z.vValueType,v,a));var c=(u.animateY?d:1)*(B.maxY-B.minY)*b/r._getFormatDiff(z.vValueType,z.vMinValue,z.vMaxValue);return c};for(var i=0,item;item=t[i];i++){var g=(u.animateX?d:1)*I;if(z.multiple){var h=item.color||C[i%C.length];for(var k=0;k<item.value.length;k++){var j=item.value[k];var l=j<v;var m=O(i,k);var n=f(j);var o=l?B.splitLinePos:B.splitLinePos-n;if(e>=1){var p={text:item.text,value:j,indexX:k,indexY:i,fontsize:item.fontsize,fontcolor:item.fontcolor,fontweight:item.fontweight,click:item.click,mouseover:item.mouseover,mouseleave:item.mouseleave};var q=new Q(l,k,i,m,o,g,n,h,p);r.shapes[s].histograms.push(q);P(l,m,o,g,n,h,p);if(!r.coordinates.histograms[s][k]){r.coordinates.histograms[s][k]=[]}r.coordinates.histograms[s][k][i]={left:m,top:o,width:g,height:n,color:h}}else{P(l,m,o,g,n,h)}}}else{var j=item.value;var l=j<v;var m=O(i);var n=f(j);var o=l?B.splitLinePos:B.splitLinePos-n;var h=item.color||(u.histogram.useSameColor?'rgba(69,114,167,1)':C[i%C.length]);if(e>=1){var p={text:item.text,value:j,indexX:i,indexY:null,fontsize:item.fontsize,fontcolor:item.fontcolor,fontweight:item.fontweight,click:item.click,mouseover:item.mouseover,mouseleave:item.mouseleave};var q=new Q(l,i,null,m,o,g,n,h,p);r.shapes[s].histograms.push(q);P(l,m,o,g,n,h,p);r.coordinates.histograms[s][i]={left:m,top:o,width:g,height:n,color:h}}else{P(l,m,o,g,n,h)}}}};var S=function(){var h=function(x,y){var a=null;for(var i=0,shape;shape=r.shapes[s].histograms[i];i++){if(shape.left<=x&&shape.left+shape.width>=x&&shape.top<=y&&shape.top+shape.height>=y){a=shape;break}}return a};var j=function(e){var e=window.event||e;var a=r._getMouseLoction(e);var b=h(a.X,a.Y);if(b){b.click(e)}};var k=function(e){var e=window.event||e;var a=r._getMouseLoction(e);var b=h(a.X,a.Y);if(b){r._configs.cursorPointer=true}if(E.currentMouseShape!=b){var c=E.currentMouseShape;if(c){var d=typeof c.data.mouseleave=='function'?c.data.mouseleave:(u.mouseleave||null);if(d){d(c.data,e)}}if(M||E.currentMouseShape){r.redrawAll()}E.currentMouseShape=b;for(var i=0,c;c=r.shapes[s].histograms[i];i++){if(c!=b&&c.isHovered){c.isHovered=false;if(c.hideTip){c.hideTip()}}}if(b){b.isHovered=true;var f=u.mouseoverTransparency;b.redraw('rgba(255,255,255,'+(f>0&&f<1?f:0.2)+')');if(b.showTip){b.showTip()}var g=typeof b.data.mouseover=='function'?b.data.mouseover:(u.mouseover||null);if(g){g(b.data,e)}}}};r._addEventListener('click',j);r._addEventListener('mousemove',k)};var T=function(){for(var i=0,shape;shape=r.shapes[s].histograms[i];i++){shape.redraw(true)}};return{drawSegments:R,mouseEvents:S,redraw:T}};