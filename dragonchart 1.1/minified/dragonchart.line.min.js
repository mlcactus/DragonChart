if(!window.DChart){throw new Error('未能加载dragonchart.core.js，该js必须在其他DChart框架的js加载之前被引用。\n'+'Not loaded dragonchart.core.js which must be loaded before other DChart\'s js.');}else{DChart.Const.Skins.BlackAndWhite.Line={NodeLineColor:'#ffffff',AlignlineLineColor:null}}DChart.Line=DChart.getCore().__extends({GraphType:'Line',SetDefaultOptions:function(){this._resetSharedOpions();this.innerOptions=DChart.Methods.Extend(this.originalDefaultOptions,{invertAxis:false,line:{colors:null,linewidth:null,smoothline:false},labelAxis:{valueType:null,content:function(a){if(this.valueType=='d'){return a.format('yyyy-MM-dd')}else if(this.valueType=='t'){return a.format('MM-dd hh:mm')}else{return a.toString()}},minvalue:null,maxvalue:null,interval:null,sort:true},node:{show:true,nodetype:null,linecolor:null,linewidth:null,length:null,fillcolor:null},tip:{merge:false,spotdistance:10,content:function(a,b){if(b){var c='<div>';for(var i=0;i<a.length;i++){var d=this.valueType=='p'?a[i].vpercent.toFixed(2)+'%':a[i].vvalue.toString();c+=(i>0?'<br/>':'')+a[i].text+" : "+d}c+='&nbsp;</div>';return c}else{var d=this.valueType=='p'?a.vpercent.toFixed(2)+'%':a.vvalue.toString();if(this.valueType=='d'){d=a.vvalue.format('yyyy-MM-dd')}else if(this.valueType=='t'){d=a.vvalue.format('MM-dd hh:mm')}return'<div>&nbsp;'+(a.text?a.text+'：':'')+d+'&nbsp;</div>'}}},alignline:{verticalline:true,horizontalline:true,linecolor:null},scale:{drawvertical:true}});return this},Draw:function(C,D){var E=this;if(arguments.length===1){if(!DChart.Methods.IsArray(arguments[0])){D=arguments[0];C=undefined}}E.SetOptions(D);E._checkOptions();var F=E.innerOptions;if(F.labelAxis.valueType=='p'){throw new Error(DChart.Const.Language[E.Language].WrongParam+DChart.Const.Language[E.Language].LabelAxisValueTypeCannotBePercent);}E.SetData(C);E._onStart();E.tempData.recreateAssists=true;var G=F.invertAxis;E.tempData.invertAxis=G;E.shapes.nodes=[];var H=E._formatAxisData();var I=E._calculateOutersValid();var J=E._computeAxis(I);var K=E._getDrawableCoordinate();E.coordinates.draw=K;E.coordinates.line={nodes:[]};var L=F.labelAxis.valueType;var M=H.vValueType=='p';var N=(F.line.colors&&F.line.colors.length>0?F.line.colors:null)||DChart.Const.Defaults.FillColors;E.tempData.legendColors=N;var O=F.line.smoothline?E.DrawFigures.createSmoothLine:E.DrawFigures.createPointsLine;var P=DChart.Methods.IsNumber(F.tip.spotdistance)&&F.tip.spotdistance>0?F.tip.spotdistance:10;var Q=F.alignline.linecolor||DChart.Const.Defaults.AlignLineColor;var R=(G?J.maxX-J.minX:J.maxY-J.minY);var S=(G?J.maxY-J.minY:J.maxX-J.minX);var T=F.node.length||DChart.Methods.CapValue(S/100,10,6);var U=function(d,f,g,h,i){this.index=d;this.centerX=f;this.centerY=g;this.isHovered=false;this.data=i;this.nodelength=h;this.click=function(e){var a=typeof this.data.click=='function'?this.data.click:(F.click||null);if(a){a(this.data,e)}};if(F.tip.show&&typeof F.tip.content=='function'){this.tip=null;this.showTip=function(){if(this.tip){this.tip.style.display='inline'}else{var a=this.centerX+T+5;var b=this.centerY-T-10;this.tip=E._createTip(F.tip.content.call(F,this.data,false),a,b);if(this.centerX+this.tip.clientWidth>J.maxX){E._changeTip(this.tip,a-5-T-this.tip.clientWidth)}var c=this;c.tip.onclick=function(e){c.click(e)}}};this.hideTip=function(){if(this.tip){this.tip.style.display='none'}}}};var V=function(x,y,a,b){var c=F.node;if(c.show){var d=b.nodelength||T;var e=b.nodetype||c.nodetype||'c';var f=b.nodelinecolor||c.linecolor||a;var g=b.nodelinewidth||c.linewidth;var h=b.nodefillcolor||c.fillcolor||a;E.DrawFigures.createPointElement(e,x,y,d,h,true,f,g,true,true)}};var W={};var X=function(m,n){var o=function(a){var b=(F.animation?m:1)*R*E._getFormatDiff(H.vValueType,H.vMinValue,a)/E._getFormatDiff(H.vValueType,H.vMinValue,H.vMaxValue);return b};var p=function(a){if(L){return S*E._getFormatDiff(H.lValueType,H.lMinValue,a)/E._getFormatDiff(H.lValueType,H.lMinValue,H.lMaxValue)}else{if(H.multiple){return S*a/(E.innerData[0].value.length-1)}else{return S*a/(E.innerData.length-1)}}};var q=function(i,a,x,y,b,c,d,e,f,g,h,j){if(n>=1){var k={vvalue:c,lvalue:d,text:e};if(f!=null){k.vpercent=f}if(typeof g=='function'){k.click=g}if(typeof h=='function'){k.mouseover=h}if(typeof j=='function'){k.mouseleave=j}var l=new U(a,x,y,b,k);E.shapes.nodes.push(l);if(i>=0){E.coordinates.line.nodes[i][a]={centerX:x,centerY:y,length:b}}else{E.coordinates.line.nodes[a]={centerX:x,centerY:y,length:b}}}};var r,vvalue,vpercent,center1,center2;if(H.multiple){var s=[];for(var i=0,item;item=E.innerData[i];i++){var t=[];var u=item.linewidth||F.line.linewidth||DChart.Const.Defaults.LineWidth;var v=item.color||N[i%N.length];var w=item.text||'';if(n>=1){E.coordinates.line.nodes[i]=[]}var z=item.value.length;for(var k=0;k<z;k++){subitem=item.value[k];r=L?subitem[0]:k;vvalue=L?subitem[1]:subitem;vpercent=M?item.percent[k]:null;center1=(G?J.maxY-p(r):J.minX+p(r));center2=G?J.minX+o(M?vpercent:vvalue):J.maxY-o(M?vpercent:vvalue);t.push(G?[center2,center1]:[center1,center2]);q(i,k,G?center2:center1,G?center1:center2,item.nodelength||T,vvalue,r,w,vpercent,item.click,item.mouseover,item.mouseleave)}var A={points:t,linewidth:u,linecolor:v,nodetype:item.nodetype,nodelength:item.nodelength,nodelinecolor:item.nodelinecolor,nodelinewidth:item.nodelinewidth,nodefillcolor:item.nodefillcolor};s.push(A);if(n>=1){if(!W.nodeinfos){W.nodeinfos=[]}W.nodeinfos[i]=A}}for(var i=0;i<s.length;i++){var t=s[i].points;O(t,s[i].linewidth,s[i].linecolor,G);for(var j=0;j<t.length;j++){var B=t[j];V(B[0],B[1],s[i].linecolor,s[i])}}}else{var u=F.line.linewidth||DChart.Const.Defaults.LineWidth;var v=N[0];var t=[];var z=E.innerData.length;for(var i=0;i<z;i++){subitem=E.innerData[i];var w=subitem.text||'';r=L?subitem.value[0]:i;vvalue=L?subitem.value[1]:subitem.value;vpercent=M?E.innerData[i].percent:null;center1=G?J.maxY-p(r):J.minX+p(r);center2=G?J.minX+o(M?vpercent:vvalue):J.maxY-o(M?vpercent:vvalue);t.push(G?[center2,center1]:[center1,center2]);q(-1,i,G?center2:center1,G?center1:center2,subitem.nodelength||T,vvalue,r,w,vpercent,subitem.click,subitem.mouseover,subitem.mouseleave)}if(n>=1){W.points=t;W.linewidth=u;W.linecolor=v}O(t,u,v,G);for(var j=0;j<t.length;j++){var B=t[j];V(B[0],B[1],v,E.innerData[j])}}};var Y=function(){if(H.multiple){for(var i=0;i<W.nodeinfos.length;i++){var a=W.nodeinfos[i].points;O(a,W.nodeinfos[i].linewidth,W.nodeinfos[i].linecolor,G);for(var j=0;j<a.length;j++){V(a[j][0],a[j][1],W.nodeinfos[i].linecolor,W.nodeinfos[i])}}}else{var a=W.points;O(a,W.linewidth,W.linecolor,G);for(var j=0;j<a.length;j++){V(a[j][0],a[j][1],W.linecolor,E.innerData[j])}}};var Z=[];var ba=function(){var p=function(x,y){var a=null;for(var i=E.shapes.nodes.length-1;i>=0;i--){var b=E.shapes.nodes[i];if(Math.sqrt(Math.pow(x-b.centerX,2)+Math.pow(y-b.centerY,2))<=b.nodelength/2){a=b;break}}return a};var q=function(x,y){var a=[];var b=0;if(y<=J.maxY&&y>=J.minY&&x>=J.minX&&x<=J.maxX){var c=-1;var d=S/(H.tuftCount-1);var e=(G?J.maxY:J.minX);var f=(G?y:x);for(var i=1;i<H.tuftCount;i++){var g=e+(G?-i*d:(i-1)*d);var h=e+(G?-(i-1)*d:i*d);if(g<=f&&h>=f){var j=Math.abs(g-f);var k=Math.abs(h-f);if(j<P&&j<=k){c=G?i:i-1;b=g}else if(k<P&&k<=j){c=G?i-1:i;b=h}break}}for(var i=0,shape;shape=E.shapes.nodes[i];i++){if(shape.index==c){a.push(shape)}}}return{shapes:a,loc:b}};E.canvas.onclick=function(e){var e=window.event||e;var a=E._getMouseLoction(e);var b=p(a.X,a.Y);if(b){b.click(e)}};E.canvas.onmousemove=function(e){var e=window.event||e;var a=E._getMouseLoction(e);var b=H.lValueType||!H.multiple;var c=p(a.X,a.Y);if(E.tempData.currentMouseShape!=c){var d=E.tempData.currentMouseShape;if(d){var f=typeof d.data.mouseleave=='function'?d.data.mouseleave:(F.mouseleave||null);if(f){f(d.data,e)}}E.tempData.currentMouseShape=c;for(var i=0,d;d=E.shapes.nodes[i];i++){if(d!=c&&d.isHovered){d.isHovered=false;if(b&&d.hideTip){d.hideTip()}}}if(c){c.isHovered=true;if(F.mouseoverChangeCursor){E.canvas.style.cursor='pointer'}if(F.alignline.verticalline||F.alignline.horizontalline){E._createAssists(I);E._createScales(I);Y()}if(F.alignline.verticalline){E.DrawFigures.createLine(c.centerX,J.minY,c.centerX,J.maxY+1,1,Q)}if(F.alignline.horizontalline){E.DrawFigures.createLine(J.minX,c.centerY,J.maxX,c.centerY,1,Q)}if(c.showTip&&b){c.showTip()}var g=typeof c.data.mouseover=='function'?c.data.mouseover:(F.mouseover||null);if(g){g(c.data,e)}}else{if(F.mouseoverChangeCursor){E.canvas.style.cursor='auto'}if(b&&(F.alignline.verticalline||F.alignline.horizontalline)){E._createAssists(I);E._createScales(I);Y()}}}if(!b){var h=q(a.X,a.Y);if(E.loc!=h.loc){E.loc=h.loc;if(F.tip.merge){for(var i=0;i<Z.length;i++){if(Z[i]){Z[i].style.display='none'}}}else{for(var i=0,d;d=E.shapes.nodes[i];i++){if(d.hideTip){d.hideTip()}}}if(G&&F.alignline.horizontalline||!G&&F.alignline.verticalline){E._createAssists(I);E._createScales(I);Y()}if(h.shapes.length){if(!G&&F.alignline.verticalline){E.DrawFigures.createLine(h.loc,J.minY,h.loc,J.maxY+1,1,Q)}if(G&&F.alignline.horizontalline){E.DrawFigures.createLine(J.minX,h.loc,J.maxX,h.loc,1,Q)}if(F.tip.merge){if(h.shapes[0].showTip){var j=Z[h.shapes[0].index];if(!j){var k=[];var l=0;var m=0;for(var i=0,d;d=h.shapes[i];i++){k.push(d.data);m+=d.centerY;l+=d.centerX}var n=l/h.shapes.length+5;var o=m/h.shapes.length;j=E._createTip(F.tip.content.call(F,k,true),n,o);E._changeTip(j,null,o-j.clientHeight/2+10);if(n+j.clientWidth>J.maxX){E._changeTip(j,n-5-T-j.clientWidth)}Z[h.shapes[0].index]=j}j.style.display='inline'}}else{for(var i=0,d;d=h.shapes[i];i++){if(d.showTip){d.showTip()}}}}}}}};E._startDrawAndAnimation(X,ba)},_spreadSkin:function(a,b){var c=DChart.Const.Skins;if(c[a]&&c[a].Line){var d=c[a].Line;b.node={};b.alignline={};b.node.linecolor=d.NodeLineColor||null;b.alignline.linecolor=d.AlignlineLineColor||null}},_getCheckOptions:function(){return{__top:[['invertAxis','b']],line:[['colors','ca'],['linewidth','n'],['smoothline','b']],labelAxis:[['valueType','s'],['content','f'],['minvalue','n'],['maxvalue','n'],['interval','n'],['sort','b']],node:[['show','b'],['nodetype','s'],['linecolor','c'],['linewidth','n'],['length','n'],['fillcolor','c']],tip:[['merge','b'],['spotdistance','n']],alignline:[['verticalline','b'],['horizontalline','b'],['linecolor','c']],scale:[['drawvertical','b']]}}});