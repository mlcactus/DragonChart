if(!window.DChart){throw new Error('未能加载dragonchart.core.js，该js必须在其他DChart框架的js加载之前被引用。\n'+'Not loaded dragonchart.core.js which must be loaded before other DChart\'s js.');}else{DChart.Const.Skins.BlackAndWhite.Points={NodeLineColor:'#ffffff',AlignlineLineColor:null}}DChart.Points=DChart.getCore().__extends({GraphType:'Points',SetDefaultOptions:function(){this._resetSharedOpions();this.innerOptions=DChart.Methods.Extend(this.originalDefaultOptions,{invertAxis:false,labelAxis:{valueType:null,content:function(a){if(this.valueType=='d'){return a.format('yyyy-MM-dd')}else if(this.valueType=='t'){return a.format('MM-dd hh:mm')}else{return a.toString()}},minvalue:null,maxvalue:null,interval:null,sort:true},node:{colors:null,nodetype:null,linecolor:null,linewidth:null,length:null,fillcolor:null},tip:{merge:false,spotdistance:10,content:function(a,b){if(b){var c='<div>';for(var i=0;i<a.length;i++){var d=this.valueType=='p'?a[i].vpercent.toFixed(2)+'%':a[i].vvalue.toString();c+=(i>0?'<br/>':'')+a[i].text+" : "+d}c+='&nbsp;</div>';return c}else{var d=this.valueType=='p'?a.vpercent.toFixed(2)+'%':a.vvalue.toString();if(this.valueType=='d'){d=a.vvalue.format('yyyy-MM-dd')}else if(this.valueType=='t'){d=a.vvalue.format('MM-dd hh:mm')}return'<div>&nbsp;'+(a.text?a.text+'：':'')+d+'&nbsp;</div>'}}},alignline:{verticalline:true,horizontalline:true,linecolor:null},scale:{drawvertical:true}});return this},Draw:function(v,w){var z=this;if(arguments.length===1){if(!DChart.Methods.IsArray(arguments[0])){w=arguments[0];v=undefined}}z.SetOptions(w);z._checkOptions();var A=z.innerOptions;if(A.labelAxis.valueType=='p'){throw new Error(DChart.Const.Language[z.Language].WrongParam+DChart.Const.Language[z.Language].LabelAxisValueTypeCannotBePercent);}z.SetData(v);z._onStart();var B=A.invertAxis;z.tempData.invertAxis=B;z.tempData.recreateAssists=true;z.shapes.nodes=[];z.coordinates.nodes=[];var C=z._formatAxisData();var D=z._calculateOutersValid();var E=z._computeAxis(D);var F=z._getDrawableCoordinate();z.coordinates.draw=F;var G=A.labelAxis.valueType;var H=C.vValueType=='p';var I=(A.node.colors&&A.node.colors.length>0?A.node.colors:null)||DChart.Const.Defaults.FillColors;z.tempData.legendColors=I;var J=DChart.Methods.IsNumber(A.tip.spotdistance)&&A.tip.spotdistance>0?A.tip.spotdistance:10;var K=A.alignline.linecolor||DChart.Const.Defaults.AlignLineColor;var L=(B?E.maxX-E.minX:E.maxY-E.minY);var M=(B?E.maxY-E.minY:E.maxX-E.minX);var N=A.node.length||DChart.Methods.CapValue(M/100,10,6);var O=function(d,f,g,h,i,j){this.index=d;this.centerX=f;this.centerY=g;this.color=j;this.isHovered=false;this.nodelength=h;this.data=i;this.click=function(e){var a=typeof this.data.click=='function'?this.data.click:(A.click||null);if(a){a(this.data,e)}};if(A.tip.show&&typeof A.tip.content=='function'){this.tip=null;this.showTip=function(){if(this.tip){this.tip.style.display='inline'}else{var a=this.centerX+N+5;var b=this.centerY-N-10;this.tip=z._createTip(A.tip.content.call(A,this.data,false),a,b);if(this.centerX+this.tip.clientWidth>E.maxX){z._changeTip(this.tip,a-5-N-this.tip.clientWidth)}var c=this;c.tip.onclick=function(e){c.click(e)}}};this.hideTip=function(){if(this.tip){this.tip.style.display='none'}}}};var P=function(x,y,a,b){var c=A.node;var d=b.nodelength||N;var e=b.nodetype||c.nodetype||'c';var f=b.nodelinecolor||c.linecolor||a;var g=b.nodelinewidth||c.linewidth;z.DrawFigures.createPointElement(e,x,y,d,a,true,f,g,true,true)};var Q=function(l,m){var n=function(a){var b=(A.animation?l:1)*L*z._getFormatDiff(C.vValueType,C.vMinValue,a)/z._getFormatDiff(C.vValueType,C.vMinValue,C.vMaxValue);return b};var o=function(a){if(G){return M*z._getFormatDiff(C.lValueType,C.lMinValue,a)/z._getFormatDiff(C.lValueType,C.lMinValue,C.lMaxValue)}else{if(C.multiple){return M*a/(z.innerData[0].value.length-1)}else{return M*a/(z.innerData.length-1)}}};var p=function(i,a,x,y,b,c,d,e,f,g,h){if(m>=1){var j={vvalue:d,lvalue:e,text:f,click:h.click,mouseover:h.mouseover,mouseleave:h.mouseleave,nodetype:h.nodetype,nodelength:h.nodelength,nodelinecolor:h.nodelinecolor,nodelinewidth:h.nodelinewidth,nodefillcolor:h.nodefillcolor};if(g!=null){j.vpercent=g}var k=new O(a,x,y,b,j,c);z.shapes.nodes.push(k);if(i>=0){z.coordinates.nodes[i][a]={centerX:x,centerY:y,length:b}}else{z.coordinates.nodes[a]={centerX:x,centerY:y,length:b}}}};var q,vvalue,vpercent,center1,center2;if(C.multiple){for(var i=0,dataitem;dataitem=z.innerData[i];i++){var r=dataitem.text||'';var s=dataitem.color||I[i%I.length];var t=dataitem.nodetype;if(m>=1){z.coordinates.nodes[i]=[]}for(var k=0;k<dataitem.value.length;k++){u=dataitem.value[k];q=G?u[0]:k;vvalue=G?u[1]:u;vpercent=H?dataitem.percent[k]:null;center1=(B?E.maxY-o(q):E.minX+o(q));center2=B?E.minX+n(H?vpercent:vvalue):E.maxY-n(H?vpercent:vvalue);P(B?center2:center1,B?center1:center2,s,dataitem);p(i,k,B?center2:center1,B?center1:center2,dataitem.nodelength||N,s,vvalue,q,r,vpercent,dataitem)}}}else{for(var i=0;i<z.innerData.length;i++){var u=z.innerData[i];var r=u.text||'';var s=u.color||(A.node.colors&&A.node.colors.length>0?I[i%I.length]:null)||A.node.fillcolor||'#000000';q=G?u.value[0]:i;vvalue=G?u.value[1]:u.value;vpercent=H?z.innerData[i].percent:null;center1=B?E.maxY-o(q):E.minX+o(q);center2=B?E.minX+n(H?vpercent:vvalue):E.maxY-n(H?vpercent:vvalue);P(B?center2:center1,B?center1:center2,s,u);p(-1,i,B?center2:center1,B?center1:center2,u.nodelength||N,s,vvalue,q,r,vpercent,u)}}};var R=function(){var a,centerY=null;for(var i=0;i<z.shapes.nodes.length;i++){var b=z.shapes.nodes[i];P(b.centerX,b.centerY,b.color,b.data)}};var S=[];var T=function(){var p=function(x,y){var a=null;for(var i=z.shapes.nodes.length-1;i>=0;i--){var b=z.shapes.nodes[i];if(Math.sqrt(Math.pow(x-b.centerX,2)+Math.pow(y-b.centerY,2))<=b.nodelength/2){a=b;break}}return a};var q=function(x,y){var a=[];var b=0;if(y<=E.maxY&&y>=E.minY&&x>=E.minX&&x<=E.maxX){var c=-1;var d=M/(C.tuftCount-1);var e=(B?E.maxY:E.minX);var f=(B?y:x);for(var i=1;i<C.tuftCount;i++){var g=e+(B?-i*d:(i-1)*d);var h=e+(B?-(i-1)*d:i*d);if(g<=f&&h>=f){var j=Math.abs(g-f);var k=Math.abs(h-f);if(j<J&&j<=k){c=B?i:i-1;b=g}else if(k<J&&k<=j){c=B?i-1:i;b=h}break}}for(var i=0,shape;shape=z.shapes.nodes[i];i++){if(shape.index==c){a.push(shape)}}}return{shapes:a,loc:b}};z.canvas.onclick=function(e){var e=window.event||e;var a=z._getMouseLoction(e);var b=p(a.X,a.Y);if(b){b.click(e)}};z.canvas.onmousemove=function(e){var e=window.event||e;var a=z._getMouseLoction(e);var b=C.lValueType||!C.multiple;var c=p(a.X,a.Y);if(z.tempData.currentMouseShape!=c){var d=z.tempData.currentMouseShape;if(d){var f=typeof d.data.mouseleave=='function'?d.data.mouseleave:(A.mouseleave||null);if(f){f(d.data,e)}}z.tempData.currentMouseShape=c;for(var i=0,d;d=z.shapes.nodes[i];i++){if(d!=c&&d.isHovered){d.isHovered=false;if(b&&d.hideTip){d.hideTip()}}}if(c){c.isHovered=true;if(A.mouseoverChangeCursor){z.canvas.style.cursor='pointer'}if(A.alignline.verticalline||A.alignline.horizontalline){z._createAssists(D);z._createScales(D);R()}if(A.alignline.verticalline){z.DrawFigures.createLine(c.centerX,E.minY,c.centerX,E.maxY+1,1,K)}if(A.alignline.horizontalline){z.DrawFigures.createLine(E.minX,c.centerY,E.maxX,c.centerY,1,K)}if(c.showTip&&b){c.showTip()}var g=typeof c.data.mouseover=='function'?c.data.mouseover:(A.mouseover||null);if(g){g(c.data,e)}}else{if(A.mouseoverChangeCursor){z.canvas.style.cursor='auto'}if(b&&(A.alignline.verticalline||A.alignline.horizontalline)){z._createAssists(D);z._createScales(D);R()}}}if(!b){var h=q(a.X,a.Y);if(z.loc!=h.loc){z.loc=h.loc;if(A.tip.merge){for(var i=0;i<S.length;i++){if(S[i]){S[i].style.display='none'}}}else{for(var i=0,d;d=z.shapes.nodes[i];i++){if(d.hideTip){d.hideTip()}}}if(B&&A.alignline.horizontalline||!B&&A.alignline.verticalline){z._createAssists(D);z._createScales(D);R()}if(h.shapes.length){if(!B&&A.alignline.verticalline){z.DrawFigures.createLine(h.loc,E.minY,h.loc,E.maxY+1,1,K)}if(B&&A.alignline.horizontalline){z.DrawFigures.createLine(E.minX,h.loc,E.maxX,h.loc,1,K)}if(A.tip.merge){if(h.shapes[0].showTip){var j=S[h.shapes[0].index];if(!j){var k=[];var l=0;var m=0;for(var i=0,d;d=h.shapes[i];i++){k.push(d.data);m+=d.centerY;l+=d.centerX}var n=l/h.shapes.length+5;var o=m/h.shapes.length;j=z._createTip(A.tip.content.call(A,k,true),n,o);z._changeTip(j,null,o-j.clientHeight/2+10);if(n+j.clientWidth>E.maxX){z._changeTip(j,n-5-N-j.clientWidth)}S[h.shapes[0].index]=j}j.style.display='inline'}}else{for(var i=0,d;d=h.shapes[i];i++){if(d.showTip){d.showTip()}}}}}}}};z._startDrawAndAnimation(Q,T)},_spreadSkin:function(a,b){var c=DChart.Const.Skins;if(c[a]&&c[a].Points){var d=c[a].Points;b.node={};b.alignline={};b.node.linecolor=d.NodeLineColor||null;b.alignline.linecolor=d.AlignlineLineColor||null}},_getCheckOptions:function(){return{__top:[['invertAxis','b']],labelAxis:[['valueType','s'],['content','f'],['minvalue','n'],['maxvalue','n'],['interval','n'],['sort','b']],node:[['colors','ca'],['nodetype','s'],['linecolor','c'],['linewidth','n'],['length','n'],['fillcolor','c']],tip:[['merge','b'],['spotdistance','n']],alignline:[['verticalline','b'],['horizontalline','b'],['linecolor','c']],scale:[['drawvertical','b']]}}});