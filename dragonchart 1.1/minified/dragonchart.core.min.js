Function.prototype.__extends=function(a){for(var b in a){this.prototype[b]=a[b]}return this};Date.prototype.format=function(a){var o={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),"S":this.getMilliseconds()};if(/(y+)/.test(a)){a=a.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))}for(var k in o){if(new RegExp("("+k+")").test(a)){a=a.replace(RegExp.$1,(RegExp.$1.length==1)?(o[k]):(("00"+o[k]).substr((""+o[k]).length)))}}return a};Date.prototype.addMinutes=function(a){var b=this.getMinutes();this.setMinutes(b+a);return this};Date.prototype.addDays=function(a){var b=this.getDate();this.setDate(b+a);return this};Date.prototype.shortOf=function(a,b){switch(a){case"s":return parseInt((b-this)/1000);case"n":return parseInt((b-this)/60000);case"h":return parseInt((b-this)/3600000);case"d":return parseInt((b-this)/86400000);case"w":return parseInt((b-this)/(86400000*7));case"m":return(b.getMonth()+1)+((b.getFullYear()-this.getFullYear())*12)-(this.getMonth()+1);case"y":return b.getFullYear()-this.getFullYear();default:return undefined}};Array.prototype.__copy=function(){var a=[];for(var i=0;i<this.length;i++){a.push(this[i])}return a};Array.prototype.__multiply=function(a){for(var i=0;i<this.length;i++){this[i]=this[i]*a}};Array.prototype.__contains=function(a){var b=false;for(var i=0;i<this.length;i++){if(this[i]===a){b=true;break}}return b};Array.prototype.__only=function(a){var b=true;for(var i=0;i<this.length;i++){if(this[i]!==a){b=false;break}}return b};window.DChart={};DChart.Methods={JudgeNormalObject:function(a){return a&&typeof a=='object'&&!DChart.Methods.IsArray(a)},DeepCopy:function(e){var f={};var g=function(a,b,c){backupPath=c;for(var d in b){c+=d+'.';if(DChart.Methods.JudgeNormalObject(b[d])&&!DChart.Const.Exceps.__contains(c.substring(0,c.length-1))){a[d]={};g(a[d],b[d],c)}else{if(b.hasOwnProperty(d)){a[d]=b[d]}}c=backupPath}};g(f,e,'');return f},Override:function(f,g){var h=DChart.Methods.DeepCopy(f);var i=function(a,b,c){var d=c;for(var e in b){c+=e+'.';if(a[e]!==undefined&&b.hasOwnProperty(e)){if(DChart.Methods.JudgeNormalObject(b[e])&&DChart.Methods.JudgeNormalObject(a[e])&&!DChart.Const.Exceps.__contains(c.substring(0,c.length-1))){i(a[e],b[e],c)}else{a[e]=b[e]}}c=d}};i(h,g,'');return h},Extend:function(f,g){var h=DChart.Methods.DeepCopy(f);var i=function(a,b,c){var d=c;for(var e in b){if(b.hasOwnProperty(e)){if(DChart.Methods.JudgeNormalObject(b[e])&&!DChart.Const.Exceps.__contains(c.substring(0,c.length-1))){if(!DChart.Methods.JudgeNormalObject(a[e])){a[e]={}}i(a[e],b[e])}else{a[e]=b[e]}}c=d}};i(h,g,'');return h},CapValue:function(a,b,c){if(DChart.Methods.IsNumber(b)&&a>b){return b}if(DChart.Methods.IsNumber(c)&&a<c){return c}return a},GetRandomString:function(){return Math.random().toString().substring(2)},GetCurrentAngle:function(x,y,a,b){var c=Math.asin((y-b)/Math.sqrt(Math.pow(x-a,2)+Math.pow(y-b,2)));if(c!=0){if(x<a&&y>b){c=Math.PI-c}else if(x<a&&y<b){c=-Math.PI-c}}else{if(x<a){c=Math.PI}}return c},JudgeBetweenAngle:function(a,b,c){var d=false;var e=Math.PI;while(c<=b){if(c>=a){d=true;break}c+=e*2}if(!d){while(c>=a){if(c<=b){d=true;break}c-=e*2}}return d},CopyInnerValue:function(a,b){if(a=='d'||a=='t'){return new Date(b.getTime())}return b},AddInnerValue:function(a,b,c){if(a=='d'){b=b.addDays(c)}else if(a=='t'){b=b.addMinutes(c)}else{b+=c}return b},FormatLinePosition:function(b,x,y){var b=Math.ceil(b);var c=function(a){var i=Math.floor(a);if(b%2==0){return a-i>0.5?i+1:i}else{return i+0.5}};if(arguments.length==3){return{x:c(x),y:c(y)}}else{return c(x)}},ObjectHaveSameValues:function(a,b,c){var d=true;for(var i=0,field;field=c[i];i++){if(a[field]!==b[field]){d=false;break}}return d},IsArray:function(a){return Object.prototype.toString.call(a)==='[object Array]'},IsNumber:function(n){return!isNaN(parseFloat(n))&&isFinite(n)},IsColor:function(a){return DChart.Const.RegExps.HexColor.test(a)||DChart.Const.RegExps.RGBColor.test(a)||DChart.Const.RegExps.RGBAColor.test(a)},ParseDate:function(a){return new Date(Date.parse(a.replace(/-/g,"/")))},IsDate:function(a){return(typeof a=='object')&&a.constructor==Date},FormatNumber:function(a){if(typeof a!='number'){return a}var b=a;for(var i=0;i<8;i++){var c=parseFloat(a.toFixed(i));if(Math.abs(c-a)<0.00001){b=c;break}}return b}};DChart.Const={Language:{CN:{WrongParam:'参数错误！',WrongData:'数据错误！',WrongSet:'设置错误！',NeedDiv:'需传入一个div节点元素或其id。',DataMustBeArray:'数据不能为空且必须为数组格式。',FirstValueShouldBeString:'数据第一个项必须为字符串以表示text',ValueMustNotBeUndefined:'数据的值不能为空',HexColorMalformed:'十六进制的颜色表达形式格式错误。',RGBColorMalformed:'rgb的颜色表达形式格式错误。',RGBAChangeTransparencyWrongParam:'RGBA表达式格式错误，或透明度值错误，必须>=0且<=1。',NeedDateData:'数据必须是日期格式。',NeedNumberData:'数据必须是数字格式。',OuterRadiusShouldBigger:'环状图外部半径应大于内部半径',AxisMaxLessThanMin:'坐标设定的最大值应该大于最小值。',AxisMaxLessThanActual:'坐标设定的最大值应该大于实际数据的最大值。',AxisMinMoreThanActual:'坐标设定的最小值应该小于实际数据的最小值。',LabelAxisValueTypeCannotBePercent:'文本轴的数据类型不能为百分数。',LabelDistanceExceedMax:'文本开始间距与结束间距不能为负数且之和不能超出最大值。',ValueTypeMustBeNumberOrPercent:'值轴的数据类型必须为n或p。',ValueTypeMustNotBePercent:'值轴的数据类型不能为p。',AxisVauleShouldBeDArray:'数据必须为二维数组（第一个元素为文本轴值，第二个元素为值轴值）。',DataMustGreaterThanZero:'数据必须为不小于零的数字。',SubItemsValueShouldEqualSuperValue:'子节点值的总和应该等于上级母节点的值。',DataMustBeMultipleArray:'数据必须为多维数组。',SumOfLengthsMustBeLessThanRadius:'环状图的宽度之和应小于半径',OptionShouldNotBeUndefined:'选项值不能为undefined',OptionShouldBeString:'选项值必须为字符串格式。',OptionShouldBeBoolean:'选项值必须为布尔格式。',OptionShouldBeNumber:'选项值必须为数字格式。',OptionShouldBeColorStr:'选项值必须为颜色格式的字符串。',OptionShouldBeFunction:'选项值必须为一个function。',OptionShouldBeColorArray:'选项值必须为由颜色字符串组成的数组。',OptionShouldBeStringArray:'选项值必须为由字符串组成的数组。',OptionShouldBeNumberArray:'选项值必须为由数字组成的数组。',WrongLegendSet:'错误的图例位置设置，不允许X和Y方向上都居中或者当type为\"row\"时Y方向居中。',WrongSplitPoint:'错误的临界值设定，该值必须大于实际最小值并小于实际最大值。'},EN:{WrongParam:'Wrong parameter!',WrongData:'Wrong data!',WrongSet:'Wrong set！',NeedDiv:'A div DOM element or its id is needed.',DataMustBeArray:'data must not be empty and be an array.',FirstValueShouldBeString:'To indicate text property that the first item of data must be a string.',ValueMustNotBeUndefined:'The value of data must not be null or undefined.',HexColorMalformed:'Hex color expression is wrong.',RGBColorMalformed:'Rgb color expression is wrong.',RGBAChangeTransparencyWrongParam:'RGBA expression is wrong，or transparency number is unqualified, it must be >=0 and <=1.',NeedDateData:'Data must be a date format.',NeedNumberData:'Data must be a number format.',OuterRadiusShouldBigger:'Ring graphic outer radius should be larger than the internal radius',AxisMaxLessThanMin:'The maximum value set of axis should be greater than the minimum value.',AxisMaxLessThanActual:'The maximum value set of axis should be greater than the actual maximum value.',AxisMinMoreThanActual:'The minimum value set of axis should be less than the actual minimum value.',LabelAxisValueTypeCannotBePercent:'The valueType of text-axis cannot be percent.',LabelDistanceExceedMax:'label distance should not be negative and the sum of label distance should be less than the max length.',ValueTypeMustBeNumberOrPercent:'The valueType of value-axis must be n or p.',ValueTypeMustNotBePercent:'The valueType of value-axis cannot be percent.',AxisVauleShouldBeDArray:'Data must be double-array（first value for label axis，second for value axis）',DataMustGreaterThanZero:'Data must not be less than zero.',SubItemsValueShouldEqualSuperValue:'The sum of value of subitems should equal the value of mother node.',DataMustBeMultipleArray:'Data must be multiple array.',SumOfLengthsMustBeLessThanRadius:'The sum of lengths in multiring picture must be less than the radius set',OptionShouldNotBeUndefined:'Option value should not be undefined.',OptionShouldBeString:'Option value should be a string.',OptionShouldBeBoolean:'Option value should be a boolean.',OptionShouldBeNumber:'Option value should be a number.',OptionShouldBeColorStr:'Option value should be a string array.',OptionShouldBeFunction:'Option value should be a function.',OptionShouldBeColorArray:'Option value should be a color array.',OptionShouldBeStringArray:'Option value should be a string array.',OptionShouldBeNumberArray:'Option value should be a number array.',WrongLegendSet:'Wrong legend position sets, direction X and direction Y cannot be center(middle) at the same time, and when type is \"row\" direction Y cannot be middle.',WrongSplitPoint:'Wrong split point, the value should be less than min data value and more than max data value.'}},CustomCss:{tip_blue:'{box-shadow: 0px 0px 4px rgb(102, 102, 102); border: 2px solid rgb(13, 142, 207); border-radius: 5px 5px 5px 5px; position: absolute; z-index: 999; text-align: left; padding: 4px 5px; cursor: default; background-color: rgba(239, 239, 239, 0.85); font-size: 12px; color: rgb(13, 142, 207); opacity: 1; transition: opacity 0.3s ease-out 0s, top 0.1s ease-out 0s, left 0.1s ease-out 0s; top: 245.66px; left: 308.333px; visibility: visible;}',tip_red:'{box-shadow: 0px 0px 4px rgb(102, 102, 102); border: 2px solid rgb(176, 23,  31); border-radius: 5px 5px 5px 5px; position: absolute; z-index: 999; text-align: left; padding: 4px 5px; cursor: default; background-color: rgba(239, 239, 239, 0.85); font-size: 12px; color: rgb(176, 23,  31); opacity: 1; transition: opacity 0.3s ease-out 0s, top 0.1s ease-out 0s, left 0.1s ease-out 0s; top: 245.66px; left: 308.333px; visibility: visible;}',tip_dark:'{box-shadow: 0px 0px 4px rgb(102, 102, 102); border: 2px solid rgb(79 , 79, 79  ); border-radius: 5px 5px 5px 5px; position: absolute; z-index: 999; text-align: left; padding: 4px 5px; cursor: default; background-color: rgba(239, 239, 239, 0.85); font-size: 12px; color: rgb(79 , 79, 79  ); opacity: 1; transition: opacity 0.3s ease-out 0s, top 0.1s ease-out 0s, left 0.1s ease-out 0s; top: 245.66px; left: 308.333px; visibility: visible;}',tip_purple:'{box-shadow: 0px 0px 4px rgb(102, 102, 102); border: 2px solid rgb(138,43,226); border-radius: 5px 5px 5px 5px; position: absolute; z-index: 999; text-align: left; padding: 4px 5px; cursor: default; background-color: rgba(239, 239, 239, 0.85); font-size: 12px; color: rgb(138,43,226); opacity: 1; transition: opacity 0.3s ease-out 0s, top 0.1s ease-out 0s, left 0.1s ease-out 0s; top: 245.66px; left: 308.333px; visibility: visible;}',tip_yellow:'{box-shadow: 0px 0px 4px rgb(102, 102, 102); border: 2px solid rgb(255,128,0); border-radius: 5px 5px 5px 5px; position: absolute; z-index: 999; text-align: left; padding: 4px 5px; cursor: default; background-color: rgba(239, 239, 239, 0.85); font-size: 12px; color: rgb(255,128,0); opacity: 1; transition: opacity 0.3s ease-out 0s, top 0.1s ease-out 0s, left 0.1s ease-out 0s; top: 245.66px; left: 308.333px; visibility: visible;}',tip_bisque:'{box-shadow: 0px 0px 4px rgb(102, 102, 102); border: 2px solid #BEBEBE; border-radius: 5px 5px 5px 5px; position: absolute; z-index: 999; text-align: left; padding: 4px 5px; cursor: default; background-color: rgba(239, 239, 239, 0.85); font-size: 12px; color: rgb(190,190,190);; opacity: 1; transition: opacity 0.3s ease-out 0s, top 0.1s ease-out 0s, left 0.1s ease-out 0s; top: 245.66px; left: 308.333px; visibility: visible;}'},AnimationAlgorithms:{linear:function(t){return t},easeInQuad:function(t){return t*t},easeOutQuad:function(t){return-1*t*(t-2)},easeInOutQuad:function(t){if((t/=1/2)<1)return 1/2*t*t;return-1/2*((--t)*(t-2)-1)},easeInCubic:function(t){return t*t*t},easeOutCubic:function(t){return 1*((t=t/1-1)*t*t+1)},easeInOutCubic:function(t){if((t/=1/2)<1)return 1/2*t*t*t;return 1/2*((t-=2)*t*t+2)},easeInQuart:function(t){return t*t*t*t},easeOutQuart:function(t){return-1*((t=t/1-1)*t*t*t-1)},easeInOutQuart:function(t){if((t/=1/2)<1)return 1/2*t*t*t*t;return-1/2*((t-=2)*t*t*t-2)},easeInQuint:function(t){return 1*(t/=1)*t*t*t*t},easeOutQuint:function(t){return 1*((t=t/1-1)*t*t*t*t+1)},easeInOutQuint:function(t){if((t/=1/2)<1)return 1/2*t*t*t*t*t;return 1/2*((t-=2)*t*t*t*t+2)},easeInSine:function(t){return-1*Math.cos(t/1*(Math.PI/2))+1},easeOutSine:function(t){return 1*Math.sin(t/1*(Math.PI/2))},easeInOutSine:function(t){return-1/2*(Math.cos(Math.PI*t/1)-1)},easeInExpo:function(t){return(t==0)?1:1*Math.pow(2,10*(t/1-1))},easeOutExpo:function(t){return(t==1)?1:1*(-Math.pow(2,-10*t/1)+1)},easeInOutExpo:function(t){if(t==0)return 0;if(t==1)return 1;if((t/=1/2)<1)return 1/2*Math.pow(2,10*(t-1));return 1/2*(-Math.pow(2,-10*--t)+2)},easeInCirc:function(t){if(t>=1)return t;return-1*(Math.sqrt(1-(t/=1)*t)-1)},easeOutCirc:function(t){return 1*Math.sqrt(1-(t=t/1-1)*t)},easeInOutCirc:function(t){if((t/=1/2)<1)return-1/2*(Math.sqrt(1-t*t)-1);return 1/2*(Math.sqrt(1-(t-=2)*t)+1)},easeInElastic:function(t){var s=1.70158;var p=0;var a=1;if(t==0)return 0;if((t/=1)==1)return 1;if(!p)p=1*.3;if(a<Math.abs(1)){a=1;var s=p/4}else var s=p/(2*Math.PI)*Math.asin(1/a);return-(a*Math.pow(2,10*(t-=1))*Math.sin((t*1-s)*(2*Math.PI)/p))},easeOutElastic:function(t){var s=1.70158;var p=0;var a=1;if(t==0)return 0;if((t/=1)==1)return 1;if(!p)p=1*.3;if(a<Math.abs(1)){a=1;var s=p/4}else var s=p/(2*Math.PI)*Math.asin(1/a);return a*Math.pow(2,-10*t)*Math.sin((t*1-s)*(2*Math.PI)/p)+1},easeInOutElastic:function(t){var s=1.70158;var p=0;var a=1;if(t==0)return 0;if((t/=1/2)==2)return 1;if(!p)p=1*(.3*1.5);if(a<Math.abs(1)){a=1;var s=p/4}else var s=p/(2*Math.PI)*Math.asin(1/a);if(t<1)return-.5*(a*Math.pow(2,10*(t-=1))*Math.sin((t*1-s)*(2*Math.PI)/p));return a*Math.pow(2,-10*(t-=1))*Math.sin((t*1-s)*(2*Math.PI)/p)*.5+1},easeInBack:function(t){var s=1.70158;return 1*(t/=1)*t*((s+1)*t-s)},easeOutBack:function(t){var s=1.70158;return 1*((t=t/1-1)*t*((s+1)*t+s)+1)},easeInOutBack:function(t){var s=1.70158;if((t/=1/2)<1)return 1/2*(t*t*(((s*=(1.525))+1)*t-s));return 1/2*((t-=2)*t*(((s*=(1.525))+1)*t+s)+2)},easeInBounce:function(t){return 1-DChart.Const.AnimationAlgorithms.easeOutBounce(1-t)},easeOutBounce:function(t){if((t/=1)<(1/2.75)){return 1*(7.5625*t*t)}else if(t<(2/2.75)){return 1*(7.5625*(t-=(1.5/2.75))*t+.75)}else if(t<(2.5/2.75)){return 1*(7.5625*(t-=(2.25/2.75))*t+.9375)}else{return 1*(7.5625*(t-=(2.625/2.75))*t+.984375)}},easeInOutBounce:function(t){if(t<1/2)return DChart.Const.AnimationAlgorithms.easeInBounce(t*2)*.5;return DChart.Const.AnimationAlgorithms.easeOutBounce(t*2-1)*.5+1*.5}},RegExps:{BlankCharacter:/\s/g,HexColor:/^#[a-fA-F0-9]{5}[a-fA-F0-9]$/,RGBColor:/^(rgb)\([0-9]{0,3},[0-9]{0,3},[0-9]{0,3}\)/,RGBAColor:/^(rgba)\([0-9]{0,3},[0-9]{0,3},[0-9]{0,3},(0.)?[0-9]+\)/,ReturnFunction:/function *\(.*\) *\{.*return.*\}$/,NormalFunction:/function *\(.*\) *\{.*\}$/},Defaults:{FillColors:['#3F5C71','#2F4F4F','#0d233a','#910000','#2A962A','#778088','#4F7DE7','#b5bcc5','#1aadce','#484848','#3883bd','#a5aaaa','#782A56','#B97944','#7A3C9C','#a6bfd2','#008B8B','#7d7f97','#4F4F4F','#9F2626'],TransparentColors:['rgba(72,72,72,0.5)','rgba(56,131,189,0.5)','rgba(13,35,58,0.5)','rgba(42,150,42,0.5)','rgba(119,128,136,0.5)','rgba(79,125,231,0.5)','rgba(26,173,206,0.5)','rgba(165,170,170,0.5)','rgba(145,0,0,0.5)','rgba(120,42,86,0.5)','rgba(47,79,79,0.5)','rgba(185,121,68,0.5)','rgba(122,60,156,0.5)','rgba(166,191,210,0.5)','rgba(0,139,139,0.5)','rgba(63,92,113,0.5)','rgba(159,38,38,0.5)','rgba(125,127,151,0.5)','rgba(181,188,197,0.5)','rgba(79,79,79,0.5)'],Language:'CN',SavedPicName:'exportCanvas_'+(new Date()).getTime(),LineColor:'#BEBEBE',FontColor:'#000000',FontSize:13,FontFamily:'Arial',LineWidth:1,LegendType:'s',TipType:'tip_blue',InnerLabelColor:'#ffffff',OuterLabelColor:'#000000',ValueType:'n',ScaleLineColor:'#BEBEBE',AxisLineColor:'#000000',FooterFontColor:'#8B8386',AlignLineColor:'#21251e',FooterBottomDistance:0.01,FooterRightDistance:0.03,LengthReferCutForPies:60,LengthReferCutForAxis:90,OffXCutForPies:20,OffXCutForAxis:70,AxisXDrawableCut:6,AxisYDrawableCut:{n:9,p:9,d:7,t:7},AxisYTitleLocation:{n:0.7,p:0.7,d:0.75,t:0.75},AxisXTitleLocation:{n:0.8,p:0.8,d:0.8,t:0.8}},Exceps:['background.fillstyle'],DrawAxis:['Bar','HeapBar','RangeBar','Histogram','HeapHistogram','RangeHistogram','Line','Points','Area','RangeArea','QueueBar','QueueHistogram'],AxisFromFirstLeft:['Line','Area','Points','RangeArea'],DrawSplitLine:['QueueBar','QueueHistogram'],Skins:{BlackAndWhite:{BackGround:{BorderWidth:1,BorderColor:null,BackColor:'#ffffff',LinearGradient:null,RadialGradient:null},TipType:null,FontColor:null,LineColor:null,FontFamily:null,TitleColor:null,SubTitleColor:null,LegendFontColor:null,LegendBorderColor:null,ScaleLineColor:null,ScaleBackColors:['rgba(150,150,150,0.3)','rgba(210,210,210,0.3)'],LabelAxisLineColor:null,LabelAxisFontColor:null,ValueAxisLineColor:null,ValueAxisFontColor:null,SplitLineColor:null,CrossLineColor:null,CloseLineColor:null,CaptionFontColor:null,XAxisTitleFontColor:null,YAxisTitleFontColor:null,FooterFontColor:'rgba(110,110,110,0.8)',ShadowColor:'#000000'}},Interval:{n:[1,2,3,4,5,8,10,20,30,40,50,80,100,200,300,500,800,1000],p:[1,2,3,4,5,8,10,20,25,50],d:[1,2,3,5,7,10,14,20,21,30,60,90,365],t:[1,2,5,10,20,30,60,120,180,240,300,480,720,1440]}};DChart.getCore=function(){var be=function(U,V){var W=this;W.Language=DChart.Const.Language[V]!=undefined?V:'CN';W.onStart=null;W.onBeforeAnimation=null;W.onAnimation=null;W.onFinish=null;var Z=null;var bf=false;if(U){if(typeof U=='string'&&U.constructor==String){var bg=document.getElementById(U);if(bg!=null&&bg.nodeName.toLowerCase()=='div'){Z=bg}else{bf=true}}else if(typeof U=='object'&&U.nodeName!=undefined&&U.nodeName.toLowerCase()=='div'){Z=U}else{bf=true}}else{bf=true}if(bf){throw new Error(DChart.Const.Language[W.Language].WrongParam+DChart.Const.Language[W.Language].NeedDiv);}else{if(Z.clientWidth==0){Z.style.width="800px"}if(Z.clientHeight==0){Z.style.height=(Z.clientWidth/2).toString()+"px"}Z.style.position='relative';Z.style.left='0px';Z.style.top='0px';Z.style.padding=''}var bh=function(a){if(a!=null){return a<0?0:a}else{return null}};var bi={Off:0,OffLeft:null,OffRight:null,OffTop:null,OffBottom:null,Width:null,Height:null};W._computeBasic=function(a){var b=a||bi;var c=bh(b.Off);var d=bh(b.OffLeft)||c||0;var e=bh(b.offright)||c||0;var f=bh(b.offtop)||c||0;var g=bh(b.offbottom)||c||0;var h=bh(Z.clientWidth-d-e);var i=bh(Z.clientHeight-f-g);var j=DChart.Methods.CapValue(b.Width||h,Z.clientWidth,0);var k=DChart.Methods.CapValue(b.Height||i,Z.clientHeight,0);var l={offleft:d,offright:e,offtop:f,offbottom:g,width:j,height:k};if(!a){W.calculatedBasic=l}return l};W._resetSharedOpions=function(){W.originalDefaultOptions={valueType:null,animation:true,animationSteps:100,animationEasing:'easeInOutQuart',scaleOverlay:false,lineColor:null,fontFamily:null,fontColor:null,background:{bordercolor:null,borderwidth:null,fillstyle:null},title:{show:true,content:null,color:null,fontfamily:null,fontsize:null,fontweight:null,offtop:null,height:null},subTitle:{show:true,content:null,color:null,fontfamily:null,fontsize:null,fontweight:null,height:null},legend:{show:true,type:null,elementtype:null,placeX:null,placeY:null,sidelength:null,offX:null,offY:null,bordercolor:null,borderwidth:1,fontcolor:null,fontsize:null,fontfamily:null},scale:{linewidth:1,linecolor:null,backcolors:null},labelAxis:{labels:null,startlength:null,endlength:null,length:null,linewidth:1,linecolor:null,fontcolor:null,fontsize:null,fontfamily:null,fontweight:null,fontrotate:null},valueAxis:{length:null,content:function(a){if(this.valueType=='d'){return a.format('yyyy-MM-dd')}else if(this.valueType=='t'){return a.format('MM-dd hh:mm')}else if(this.valueType=='p'){return a.toFixed(0).toString()+'%'}else{return a.toString()}},minvalue:null,maxvalue:null,interval:null,verticalcomputeP:false,linewidth:null,linecolor:null,fontcolor:null,fontsize:null,fontfamily:null,fontweight:null,fontrotate:null},splitLine:{show:false,linecolor:null,linewidth:null},cross:{show:true,length:null,linewidth:null,linecolor:null},close:{show:true,linewidth:null,linecolor:null},caption:{content:null,fontcolor:null,fontsize:null,fontfamily:null,fontweight:null},xAxisTitle:{content:null,fontcolor:null,fontsize:null,fontfamily:null,fontweight:null,titlelocation:null},yAxisTitle:{content:null,fontcolor:null,fontsize:null,fontfamily:null,fontweight:null,titlelocation:null},footer:{content:null,fontcolor:null,fontsize:null,fontfamily:null,fontweight:null,rightdistance:null,bottomdistance:null},shadow:{show:true,color:null,blur:null,offsetX:null,offsetY:null},supportMouseEvents:true,tip:{show:true,content:function(a){var b=a.value.toString();if(this.valueType=='d'){b=a.value.format('yyyy-MM-dd')}else if(this.valueType=='t'){b=a.value.format('MM-dd hh:mm')}return'<div>&nbsp;'+a.text+'：'+b+'&nbsp;</div>'},tiptype:null},click:null,mouseover:null,mouseleave:null,mouseoverTransparency:0.3,mouseoverChangeCursor:true,onAnimationComplete:null}};W.SetBasicOptions=function(a){var b=W._computeBasic(a);if(W.calculatedBasic&&DChart.Methods.ObjectHaveSameValues(W.calculatedBasic,b,['offleft','offright','offtop','offbottom','height','width'])){return}bi=DChart.Methods.Override(bi,a);W.Initial();return W};W._TransferArrayDataToObject=function(a){var b={};var c=DChart.Const.Language[W.Language];if(a[0]&&typeof a[0]=='string'){b.text=a[0]}else{throw new Error(c.WrongParam+'\''+a+'\''+c.FirstValueShouldBeString);}if(a[1]!=null){b.value=a[1]}else{throw new Error(c.WrongParam+'\''+a+'\''+c.ValueMustNotBeUndefined);}var d=2;if(DChart.Methods.IsArray(a[d])){var e=a[d];if(DChart.Methods.IsArray(e[0])&&e[0].length>0&&typeof e[0][0]=='string'){for(var i=0;i<e.length;i++){e[i]=W._TransferArrayDataToObject(e[i])}}b.subitems=e;d++}if(typeof a[d]=='string'){b.color=a[d];d++}if(typeof a[d]=='function'){b.click=a[d];d++}if(typeof a[d]=='function'){b.mouseover=a[d];d++}if(typeof a[d]=='function'){b.mouseleave=a[d]}return b};W.SetData=function(a){var b=DChart.Const.Language[W.Language];if((!a||!DChart.Methods.IsArray(a))&&(!W.innerData||!DChart.Methods.IsArray(W.innerData))){throw new Error(b.WrongParam+b.DataMustBeArray);}if(a){if(DChart.Methods.IsArray(a[0])&&a[0].length>0&&typeof a[0][0]=='string'){var c=[];for(var i=0,item;item=a[i];i++){var d=W._TransferArrayDataToObject(item);c.push(d)}a=c}W.innerData=a}return W};W.SetOptions=function(a){if(!W.innerOptions){W.SetDefaultOptions()}if(a){W.innerOptions=DChart.Methods.Override(W.innerOptions,a)}return W};W._onStart=function(){W.coordinates={};W.tempData={};W.canvas.onclick=null;W.canvas.onmousemove=null;if(W.onStart){W.onStart()}};W._checkOptions=function(){var j=function(c,d,e){var f=function(a){var b=DChart.Const.Language[W.Language];throw new Error(b.WrongParam+c+b[a]);};if(d===null){return}else if(d===undefined){f('OptionShouldNotBeUndefined');}var g=null;switch(e){case's':if(typeof d!='string'){f('OptionShouldBeString');}break;case'b':if(typeof d!='boolean'){f('OptionShouldBeBoolean');}break;case'c':if(typeof d!='string'||!DChart.Methods.IsColor(d)){f('OptionShouldBeColorStr');}break;case'f':if(typeof d!='function'){f('OptionShouldBeFunction');}break;case'ca':if(typeof d=='string'&&DChart.Methods.IsColor(d)){g=[d]}else{var h=true;if(DChart.Methods.IsArray(d)&&d.length){for(var i=0,str;str=d[i];i++){if(typeof str!='string'||!DChart.Methods.IsColor(str)){h=false}}}else{h=false}if(!h){f('OptionShouldBeColorArray');}}break;case'sa':if(typeof d=='string'){g=[d]}else{var h=true;if(DChart.Methods.IsArray(d)&&d.length){for(var i=0,str;str=d[i];i++){if(typeof str!='string'){h=false}}}else{h=false}if(!h){f('OptionShouldBeStringArray');}}break;case'na':if(typeof d=='number'&&DChart.Methods.IsNumber(d)){g=[d]}else{var h=true;if(DChart.Methods.IsArray(d)&&d.length){for(var i=0;i<d.length;i++){if(typeof d[i]!='number'||!DChart.Methods.IsNumber(d[i])){h=false}}}else{h=false}if(!h){f('OptionShouldBeNumberArray');}}break;default:if(typeof d!='number'||!DChart.Methods.IsNumber(d)){f('OptionShouldBeNumber');}break}return g};var k={__top:[['valueType','s'],['animation','b'],['animationSteps','n'],['animationEasing','s'],['scaleOverlay','b'],['lineColor','c'],['fontFamily','s'],['fontColor','c'],['supportMouseEvents','b'],['click','f'],['mouseover','f'],['mouseleave','f'],['mouseoverTransparency','n'],['mouseoverChangeCursor','b'],['onAnimationComplete','f']],title:[['show','b'],['content','s'],['offtop','n'],['height','n'],['color','c'],['fontsize','n'],['fontfamily','s'],['fontweight','s']],subTitle:[['show','b'],['content','s'],['height','n'],['color','c'],['fontsize','n'],['fontfamily','s'],['fontweight','s']],legend:[['show','b'],['type','s'],['elementtype','s'],['placeX','s'],['placeY','s'],['sidelength','n'],['offX','n'],['offY','n'],['bordercolor','c'],['borderwidth','n'],['fontcolor','c'],['fontsize','n'],['fontfamily','s']],background:[['bordercolor','c'],['borderwidth','n']],scale:[['linewidth','n'],['linecolor','c'],['backcolors','ca']],labelAxis:[['labels','sa'],['startlength','n'],['endlength','n'],['length','n'],['linewidth','n'],['linecolor','c'],['fontcolor','c'],['fontsize','n'],['fontfamily','s'],['fontweight','s'],['fontrotate','n']],valueAxis:[['length','n'],['content','f'],['minvalue','n'],['maxvalue','n'],['interval','n'],['verticalcomputeP','b'],['linewidth','n'],['linecolor','c'],['fontcolor','c'],['fontsize','n'],['fontfamily','s'],['fontweight','s'],['fontrotate','n']],splitLine:[['show','b'],['linewidth','n'],['linecolor','c']],cross:[['show','b'],['length','n'],['linewidth','n'],['linecolor','c']],close:[['show','b'],['linewidth','n'],['linecolor','c']],caption:[['content','s'],['fontcolor','c'],['fontsize','n'],['fontfamily','s'],['fontweight','s']],xAxisTitle:[['content','s'],['fontcolor','c'],['fontsize','n'],['fontfamily','s'],['fontweight','s'],['titlelocation','n']],yAxisTitle:[['content','s'],['fontcolor','c'],['fontsize','n'],['fontfamily','s'],['fontweight','s'],['titlelocation','n']],footer:[['content','s'],['fontcolor','c'],['fontsize','n'],['fontfamily','s'],['fontweight','s'],['rightdistance','n'],['bottomdistance','n']],shadow:[['show','b'],['color','c'],['blur','n'],['offsetX','n'],['offsetY','n']],tip:[['show','b'],['content','f'],['tiptype','s']]};var l=function(a){for(var b in a){var c=b=='__top'?W.innerOptions:W.innerOptions[b];for(var i=0,subitem;subitem=a[b][i];i++){var d=b=='__top'?subitem[0]:b+'.'+subitem[0];var e=c[subitem[0]];var f=subitem[1];var g=j(d,e,f);if(g!=null){c[subitem[0]]=g}}}};var m=W._getCheckOptions();l(k);l(m)};W.GetCoordinate=function(a){var b=W.coordinates;if(typeof a!='string'){return b}else{var c=a.replace(DChart.Const.RegExps.BlankCharacter,'').split(".");for(var i=0,item;item=c[i];i++){if(b){b=b[item]}}return b}};W.SetSkin=function(a){if(!DChart.Const.Skins[a]){a='BlackAndWhite'}var b=DChart.Const.Skins[a];var c={};c.fontColor=b.FontColor||null;c.lineColor=b.LineColor||null;c.fontFamily=b.FontFamily||null;c.background={};c.background.fillstyle=null;if(b.BackGround){c.background.bordercolor=b.BackGround.BorderColor||null;c.background.borderwidth=b.BackGround.BorderWidth||null;if(b.BackGround.BackColor){c.background.fillstyle=b.BackGround.BackColor}else{var d=b.BackGround.LinearGradient;if(d&&d.Location&&d.ColorStops&&d.ColorStops.length){var e=d.Location;var f=W.ctx.createLinearGradient(e.minX||0,e.minY||0,e.maxX||W.canvas.width,e.maxY||W.canvas.height);for(var i=0,stop;stop=d.ColorStops[i];i++){f.addColorStop(stop.offset,stop.color)}c.background.fillstyle=f}else{d=b.BackGround.RadialGradient;if(d&&d.Location&&d.ColorStops&&d.ColorStops.length){var e=d.Location;var f=W.ctx.createRadialGradient(e.x0||W.canvas.width/2,e.y0||W.canvas.height/2,e.r0||0,e.x1||W.canvas.width/2,e.y1||W.canvas.height/2,e.r1||Math.max(W.canvas.width,W.canvas.height));for(var i=0,stop;stop=d.ColorStops[i];i++){f.addColorStop(stop.offset,stop.color)}c.background.fillstyle=f}}}}c.title={};c.title.color=b.TitleColor||null;c.subTitle={};c.subTitle.color=b.SubTitleColor||null;c.legend={};c.legend.fontcolor=b.LegendFontColor||null;c.legend.bordercolor=b.LegendBorderColor||null;c.title={};c.title.color=b.TitleColor||null;c.scale={};c.scale.linecolor=b.ScaleLineColor||null;c.scale.backcolors=b.ScaleBackColors||null;c.labelAxis={};c.labelAxis.linecolor=b.LabelAxisLineColor||null;c.labelAxis.fontcolor=b.LabelAxisFontColor||null;c.valueAxis={};c.valueAxis.linecolor=b.ValueAxisLineColor||null;c.valueAxis.fontcolor=b.ValueAxisFontColor||null;c.splitLine={};c.splitLine.linecolor=b.SplitLineColor||null;c.cross={};c.cross.linecolor=b.CrossLineColor||null;c.close={};c.close.linecolor=b.CloseLineColor||null;c.caption={};c.caption.fontcolor=b.CaptionFontColor||null;c.xAxisTitle={};c.xAxisTitle.fontcolor=b.XAxisTitleFontColor||null;c.yAxisTitle={};c.yAxisTitle.fontcolor=b.YAxisTitleFontColor||null;c.footer={};c.footer.fontcolor=b.FooterFontColor||null;c.shadow={};c.shadow.color=b.ShadowColor||null;c.tip={};c.tip.tiptype=b.TipType||null;W._spreadSkin(a,c);W.innerOptions=DChart.Methods.Override(W.innerOptions,c);return W};W.randoms={};W.shapes={};W.Initial=function(){var a=Z.children;for(var i=0,child;child=a[i];i++){if(child.nodeName.toLowerCase()=='canvas'){Z.removeChild(child);break}}var b=document.getElementsByTagName('head')[0];var c=b.getElementsByTagName('style');for(var i=0,d;d=c[i];i++){if(d.id.indexOf('DChart')==0){b.removeChild(d)}}var d=document.createElement('style');var e='DChart'+DChart.Methods.GetRandomString();d.id=e;W.randoms.styleID=e;b.appendChild(d);var f=DChart.Const.CustomCss;for(var g in f){if(f.hasOwnProperty(g)){var h=g+DChart.Methods.GetRandomString();W.randoms[g]=h;var j='.'+h+f[g]+'\n';if(d.styleSheet){d.styleSheet.cssText+=j}else{d.appendChild(document.createTextNode(j))}}}W._computeBasic();var k=document.createElement('canvas');var l='DChart'+DChart.Methods.GetRandomString();W.ID=l;k.setAttribute('id',l);W.randoms.canvasID=l;k.width=W.calculatedBasic.width;k.height=W.calculatedBasic.height;d='margin:'+W.calculatedBasic.offtop+'px '+W.calculatedBasic.offright+'px '+W.calculatedBasic.offbottom+'px '+W.calculatedBasic.offleft+'px;';k.innerHTML='<p>您的浏览器不支持HTML5</p>';k.setAttribute('style',d);Z.appendChild(k);W.canvas=k;W.ctx=k.getContext('2d');W.innerData=[];W.SetDefaultOptions();W.ClearBackGround()};W.SavePic=function(e,f){f=f||'png';var g=function(a){a=a.toLowerCase().replace(/jpg/i,'jpeg');var r=a.match(/png|jpeg|bmp|gif/)[0];return'image/'+r};var h=function(a,b){var c=document.createElementNS('http://www.w3.org/1999/xhtml','a');c.href=a;c.download=b;var d=document.createEvent('MouseEvents');d.initMouseEvent('click',true,false,window,0,0,0,0,0,false,false,false,false,0,null);c.dispatchEvent(d)};var i=W.canvas.toDataURL(g(f));i=i.replace(g(f),'image/octet-stream');var e=(e||DChart.Const.Defaults.SavedPicName)+'.'+f;h(i,e)};W._clearTips=function(){var a=Z.children;for(var i=0,child;child=a[i];i++){if(child.nodeName&&child.nodeName.toLowerCase()!='canvas'){Z.removeChild(child);i--}}};W.DrawFigures={};W.DrawFigures.createPointElement=function(a,X,Y,b,c,d,e,f,g,h){if(arguments.length<5){return}if(d==null){d=true}var i=W.ctx;i.save();i.beginPath();switch(a){case'c':if(h){i.arc(X,Y,b/2,0,Math.PI*2)}else{i.arc(X+b/2,Y+b/2,b/2,0,Math.PI*2)}break;case't':if(h){i.moveTo(X-b/2,Y+b/2);i.lineTo(X+b/2,Y+b/2);i.lineTo(X,Y-b/2);i.lineTo(X-b/2,Y+b/2)}else{i.moveTo(X,Y+b);i.lineTo(X+b,Y+b);i.lineTo(X+b/2,Y);i.lineTo(X,Y+b)}break;case'x':if(h){i.moveTo(X-b/2,Y-b/2);i.lineTo(X+b/2,Y+b/2);i.moveTo(X-b/2,Y+b/2);i.lineTo(X+b/2,Y-b/2)}else{i.moveTo(X,Y);i.lineTo(X+b,Y+b);i.moveTo(X,Y+b);i.lineTo(X+b,Y)}break;default:if(h){i.rect(X-b/2,Y-b/2,b,b)}else{i.rect(X,Y,b,b)}break}i.closePath();if(g&&(f>0||a=='x')){i.strokeStyle=(a=='x'?c:e);i.lineWidth=f*2;i.stroke()}if(d&&a!='x'){i.fillStyle=c;i.fill()}i.restore()};W.DrawFigures.createArc=function(a,b,c,d,e,f,g,h,i){if(arguments.length<4){return}var j=W.ctx;g=g||0;h=h||Math.PI*2;j.save();j.beginPath();j.arc(a,b,c,g,h);if(i&&Math.abs(h-g)<Math.PI*2-0.01){j.lineTo(a,b)}j.closePath();if(d>0){j.strokeStyle=e||DChart.Const.Defaults.LineColor;j.lineWidth=d;j.stroke()}if(f){j.fillStyle=f;j.fill()}j.restore()};W.DrawFigures.createRing=function(a,b,c,d,e,f,g,h,i){var j=W.ctx;j.save();j.beginPath();j.moveTo(a+d*Math.cos(f),b+d*Math.sin(f));j.arc(a,b,d,f,g);j.lineTo(a+c*Math.cos(g),b+c*Math.sin(g));j.arc(a,b,c,g,f,true);j.closePath();j.fillStyle=e;j.fill();if(h>0){j.lineWidth=h;j.strokeStyle=i||DChart.Const.Defaults.LineColor;j.stroke()}j.restore()};W.DrawFigures.measureText=function(a,b,c,d){var e=W.ctx;e.save();e.font=(b||'normal')+' '+(c||DChart.Const.Defaults.FontSize)+'px '+(d||W.innerOptions.fontFamily||DChart.Const.Defaults.FontFamily);var f=e.measureText(a).width;e.restore();return f};W.DrawFigures.createText=function(a,x,y,b,c,d,e,f,g,h){var i=W.ctx;i.save();i.textAlign=b||'left';i.font=(c||'normal')+' '+(d||DChart.Const.Defaults.FontSize)+'px '+(e||W.innerOptions.fontFamily||DChart.Const.Defaults.FontFamily);var j=i.measureText(a).width;i.fillStyle=f||W.innerOptions.fontColor||DChart.Const.Defaults.FontColor;if(g){if(b=='center'&&h=='right'){y-=Math.sin(g*Math.PI)*j/2}i.translate(x,y);i.rotate(g*Math.PI);i.fillText(a,0,0)}else{i.fillText(a,x,y)}i.restore();return j};W.DrawFigures.createRectangleFill=function(a,b,c,d,e,f){if(c<=0||d<=0){return}var g=W.ctx;g.save();g.fillStyle=e;if(f){if(f.color){g.shadowColor=f.color}if(f.blur){g.shadowBlur=f.blur}if(f.offsetX){g.shadowOffsetX=f.offsetX}if(f.offsetY){g.shadowOffsetY=f.offsetY}}g.fillRect(a,b,c,d);g.restore()};W.DrawFigures.createRectangleBorder=function(a,b,c,d,e,f){var g=W.ctx;g.save();g.beginPath();g.lineWidth=e||DChart.Const.Defaults.LineWidth;g.rect(a,b,c,d);g.closePath();g.strokeStyle=f||W.innerOptions.lineColor||DChart.Const.Defaults.LineColor;g.stroke();g.restore()};W.DrawFigures.createLine=function(a,b,c,d,e,f){var e=Math.ceil(e);if(a==c){a=c=DChart.Methods.FormatLinePosition(e,a)}else if(b==d){b=d=DChart.Methods.FormatLinePosition(e,b)}var g=W.ctx;g.save();g.lineWidth=e||DChart.Const.Defaults.LineWidth;g.strokeStyle=f||W.innerOptions.lineColor||DChart.Const.Defaults.LineColor;g.beginPath();g.moveTo(a,b);g.lineTo(c,d);g.stroke();g.restore()};W.DrawFigures.createQuadraticCurve=function(a,b,c,d,e,f,g,h){var g=Math.ceil(g);var i=W.ctx;i.save();i.beginPath();i.moveTo(a,b);i.quadraticCurveTo(c,d,e,f);i.lineWidth=g||DChart.Const.Defaults.LineWidth;i.strokeStyle=h||W.innerOptions.lineColor||DChart.Const.Defaults.LineColor;i.stroke();i.restore()};W.DrawFigures.curveSmoothPoints=function(a,b,c,d){var e=(b[0]+c[0])/2;var f=(b[1]+c[1])/2;if(d){a.quadraticCurveTo(b[0],0.5*f+0.5*b[1],e,f);a.quadraticCurveTo(c[0],0.5*f+0.5*c[1],c[0],c[1])}else{a.quadraticCurveTo(0.5*e+0.5*b[0],b[1],e,f);a.quadraticCurveTo(0.5*e+0.5*c[0],c[1],c[0],c[1])}};W.DrawFigures.createSmoothLine=function(a,b,c,d){var e=W.ctx;var f=a.length;if(f<3){return}e.save();e.lineWidth=b||DChart.Const.Defaults.LineWidth;e.strokeStyle=c||W.innerOptions.lineColor||DChart.Const.Defaults.LineColor;e.beginPath();e.moveTo(a[0][0],a[0][1]);for(var i=0;i<f-1;i++){W.DrawFigures.curveSmoothPoints(e,a[i],a[i+1])}e.stroke();e.restore()};W.DrawFigures.createCloseFigure=function(a,b,c,d,e,f){var g=W.ctx;g.save();g.beginPath();var h=a.length;g.moveTo(a[0][0],a[0][1]);for(var i=0;i<h-1;i++){if(!e){g.lineTo(a[i+1][0],a[i+1][1])}else{W.DrawFigures.curveSmoothPoints(g,a[i],a[i+1],f)}}g.closePath();g.fillStyle=b;g.fill();if(c>0&&d){g.lineWidth=c;g.strokeStyle=d;g.stroke()}g.restore()};W.DrawFigures.createPointsLine=function(a,b,c){if(a.length<2){return}var d=a[0][0];var e=a[0][1];for(var i=1,point;point=a[i];i++){var f=a[i][0];var g=a[i][1];W.DrawFigures.createLine(d,e,f,g,b,c);d=f;e=g}};W.ClearBackGround=function(){Z.style.backgroundColor='';W.ctx.clearRect(0,0,W.canvas.width,W.canvas.height);W._clearTips();for(var a in W.shapes){if(a&&W.shapes[a].length){W.shapes[a].length=0}}};W._createBackground=function(){var a=W.innerOptions.background;var b=W.canvas;if(a.fillstyle){W.DrawFigures.createRectangleFill(0,0,b.width,b.height,a.fillstyle)}else{W.ctx.clearRect(0,0,W.canvas.width,W.canvas.height)}var c=a.borderwidth||0;if(c>0){W.DrawFigures.createRectangleBorder(0,0,b.width,b.height,c*2,a.bordercolor)}W.coordinates.canvas={width:b.width,height:b.height,borderwidth:c}};W._createTip=function(a,b,c){var d=document.createElement('span');var e=W.innerOptions.tip.tiptype||DChart.Const.Defaults.TipType;d.setAttribute('class',W.randoms[e]);d.style.position='absolute';d.style.left=b+W.calculatedBasic.offleft+'px';d.style.top=c+W.calculatedBasic.offtop+'px';d.innerHTML=a;Z.appendChild(d);return d};W._changeTip=function(a,b,c){if(b){a.style.left=b+W.calculatedBasic.offleft+'px'}if(c){a.style.top=c+W.calculatedBasic.offtop+'px'}};W._getDrawableCoordinate=function(){if(!W.tempData.coordinate){var a=W.innerOptions;var b=W._calculateOutersValid();var c,minY,maxX,maxY;if(b.AxisValid){var d=W.axisSize||W._computeAxis(b);c=d.minX-1;minY=d.minY-1;maxX=d.maxX+1;maxY=d.maxY+1}else{var e=b.legendValid?W._computeLegend():null;c=(e?e.occupyLeft:0);maxX=W.canvas.width-(e?e.occupyRight:0);if(b.titleValid){minY=W._computeTitle(b).occupyTop}else{minY=0}minY+=(e?e.occupyTop:0);maxY=W.canvas.height-(e?e.occupyBottom:0);var f=a.background.borderwidth||0;c+=f;maxX-=f;minY+=f;maxY-=f}var g=(maxX+c)/2;var h=(maxY+minY)/2;W.tempData.coordinate={minX:Math.ceil(c),maxX:Math.ceil(maxX),minY:Math.ceil(minY),maxY:Math.ceil(maxY),centerX:g,centerY:h}}return W.tempData.coordinate};W._clearDrawable=function(a){var b=W.innerOptions.background;a=a||W._getDrawableCoordinate();W.ctx.clearRect(a.minX+1,a.minY+1,a.maxX-a.minX-2,a.maxY-a.minY-2);if(b.fillstyle){W.DrawFigures.createRectangleFill(a.minX+1,a.minY+1,a.maxX-a.minX-2,a.maxY-a.minY-2,b.fillstyle)}};W._computeTitle=function(a){var a=a||W._calculateOutersValid();var b=W.innerOptions.title;var c=W.innerOptions.background.borderwidth||0;var d=Math.min(W.canvas.height-c*2,W.canvas.width/2-c);var e=b.offtop!=null?b.offtop:0;var f=b.height!=null?b.height:d/15;var g=b.fontsize||d/18;b=W.innerOptions.subTitle;var h=b.height!=null?b.height:d/18;var i=b.fontsize!=null?b.fontsize:d/21;var j=(a.titleValid?f+e:0)+(a.titleValid&&a.subTitleValid?h:0)+g/4;return{title:{height:f,offtop:e,fontsize:g},subTitle:{height:h,fontsize:i},occupyTop:j}};W._createTitle=function(a){var a=a||W._calculateOutersValid();var b=W.innerOptions.title;if(!a.titleValid){return}var c=W._computeTitle(a);var d=W.innerOptions.background.borderwidth||0;var e=W.canvas.width/2;var f=d+c.title.offtop+c.title.height;var g=W.DrawFigures.createText(b.content,e,f,'center',(b.fontweight||'bold'),c.title.fontsize,b.fontfamily,b.color);W.coordinates.title={left:e-g/2,right:e+g/2,top:f-c.title.fontsize,bottom:f,fontsize:c.title.fontsize,length:g};b=W.innerOptions.subTitle;if(!a.subTitleValid){return}f=d+c.title.offtop+c.title.height+c.subTitle.height;g=W.DrawFigures.createText(b.content,e,f,'center',(b.fontweight||'bold'),c.subTitle.fontsize,b.fontfamily,b.color);W.coordinates.subTitle={left:e-g/2,right:e+g/2,top:f-c.subTitle.fontsize,bottom:f,fontsize:c.subTitle.fontsize,length:g}};W._computeLegend=function(a){if(W.tempData.legendSize){return W.tempData.legendSize}var a=a||W._calculateOutersValid();var b=W.innerOptions.background.borderwidth||0;var c=W.canvas.width-b*2;var d=W.canvas.height-b*2;var e=W.innerOptions.legend;var f=W.innerData;var g=0;var h=0;var j=e.type!='row'?'column':e.type;var k=e.placeX!='left'&&e.placeX!='center'?'right':e.placeX;var l=e.placeY!='top'&&e.placeY!='bottom'?'middle':e.placeY;if(l=='middle'&&k=='center'||j=='row'&&l=='middle'){throw new Error(DChart.Const.Language[W.Language].WrongLegendSet);}var m=e.elementtype||DChart.Const.Defaults.LegendType;var n=e.sidelength||Math.max(c,d)/(a.AxisValid?DChart.Const.Defaults.LengthReferCutForAxis:DChart.Const.Defaults.LengthReferCutForPies);var o=n/2;var p=j=='row'?n/3:n;var q=n/2;var r=e.borderwidth&&e.borderwidth>0?e.borderwidth:0;var s=e.fontsize||n*1.2;var t=e.fontfamily||W.innerOptions.fontFamily||DChart.Const.Defaults.FontFamily;var u=0;var v=[];for(var i=0,item;item=f[i];i++){v[i]=item.text||'';if(typeof item.text=='string'){var w=W.DrawFigures.measureText(item.text,null,s,t);if(u<w){u=w}}}var x=e.offX==null?c/(a.AxisValid?DChart.Const.Defaults.OffXCutForAxis:DChart.Const.Defaults.OffXCutForPies):e.offX;var y=e.offY==null?n/2:e.offY;if(m=='l'){n*=2}if(j=='column'){g=q*2+n+o+u+r*2;h=f.length*((m=='l'?n/2:n)+o)-o+p*2+r*2}else{g=f.length*(n+o*2+u)-o+q*2+r*2;h=p*2+(m=='l'?n/2:n)+r*2}var z=(k=='left'?x:(k=='center'?c/2-g/2:c+b-x-g))+r;var A=a.titleValid?W._computeTitle(a).occupyTop:0;var B=y+b+A;var C=(a.AxisValid?d/7.5:0);if(l=='bottom'){B=d+b-h-y-(k=='center'||j=='row'?0:C)}else if(l=='middle'){B=(d-A-h)/2+b+A-C/2}var D=l=='top'&&(j=='row'||j=='column'&&k=='center')?h+y+b+n/3:0;var E=l=='bottom'&&(j=='row'||j=='column'&&k=='center')?h+y+b+n/3:0;var F=k=='left'&&j=='column'?g+x:0;var G=k=='right'&&j=='column'?g+x:0;W.tempData.legendSize={legendWidth:g,legendHeight:h,type:j,placeX:k,placeY:l,elementtype:m,sidelength:n,sidedistance:o,sideoffY:p,sideoffX:q,borderwidth:r,fontsize:s,fontfamily:t,maxTextLength:u,texts:v,left:z,top:B,occupyTop:D,occupyBottom:E,occupyLeft:F,occupyRight:G};return W.tempData.legendSize};W._createLegend=function(a){var a=a||W._calculateOutersValid();if(!a.legendValid){return}var b=W.innerOptions.legend;var c=W._computeLegend();var d=W.tempData.legendColors||DChart.Const.Defaults.FillColors;var e=c.elementtype=='l';for(var i=0,item;item=W.innerData[i];i++){var f=c.left+c.sideoffX+c.borderwidth;if(c.type=='row'){f+=i*(c.sidelength+c.sidedistance*2+c.maxTextLength)}var g=c.top+c.sideoffY+c.borderwidth;if(c.type=='column'){g+=i*((e?c.sidelength/2:c.sidelength)+c.sidedistance)}var h=item.color||d[i%d.length];if(e){W.DrawFigures.createLine(f,g+c.sidelength*0.3,f+c.sidelength,g+c.sidelength*0.3,2,h)}else{W.DrawFigures.createPointElement(c.elementtype,f,g,c.sidelength,h,c.elementtype!='x',h,2,c.elementtype=='x')}W.DrawFigures.createText(c.texts[i],f+c.sidelength+(c.elementtype=='x'?5:3),g+c.sidelength*(e?0.45:0.9),null,null,c.fontsize,c.fontfamily,b.fontcolor,null)}var j=c.borderwidth;var k={borderwidth:j,left:c.left+j/2,top:c.top+j/2,width:c.legendWidth-j,height:c.legendHeight-j};W.coordinates.legend=k;if(j>0){W.DrawFigures.createRectangleBorder(k.left,k.top,k.width,k.height,j,b.bordercolor)}};W._getFormatDiff=function(a,b,c){if(b>c){var d=b;b=c;c=d}if(a=='d'){return b.shortOf('d',c)}else if(a=='t'){return b.shortOf('n',c)}else{return c-b}};W._getComputed=function(g,h,j,k,l,m){var n=DChart.Const.Language[W.Language];var o=j.minvalue;var p=j.maxvalue;var q=function(a,b,c){var d=W._getFormatDiff(c,o!=null&&o<a?o:a,p!=null&&p>b?p:b)/m;var e=DChart.Const.Interval[c].__copy();var f=false;while(!f){if(d<e[0]){e.__multiply(0.1)}if(d>e[e.length-1]){e.__multiply(10)}for(var i=1;i<e.length;i++){if(e[i-1]<=d&&e[i]>=d){f=true;d=d-e[i-1]<e[i]-d?e[i-1]:e[i];break}}}return d};var r=j.interval;if(!r){r=q(k,l,h)}if(o==null){if(h=='d'||h=='t'){var s=r*60000*(h=="d"?1440:1);o=new Date(k-s*g);if(h=='d'){o=new Date(Date.parse(o.format('yyyy/MM/dd')))}}else if(h=='p'){o=0}else{o=(Math.floor(k/r)-g)*r}}if(g&&o<0&&W.tempData.notAllowValueNegative){o=0}if(p==null){if(h=='d'||h=='t'){var s=r*60000*(h=="d"?1440:1);p=new Date(o.getTime()+(Math.ceil((l.getTime()-o.getTime())/s)+g)*s)}else{p=o+(Math.ceil((l-o)/r)+g)*r}}if(h=='p'&&p>100){p=100}var t=0;var u=DChart.Methods.CopyInnerValue(h,o);var v=DChart.Methods.AddInnerValue(h,u,r);while(v<=p||((h=='p'||h=='n')&&Math.abs(p-v)<0.0001)){v=DChart.Methods.AddInnerValue(h,v,r);t++}p=DChart.Methods.AddInnerValue(h,v,-r);p=DChart.Methods.FormatNumber(p);o=DChart.Methods.FormatNumber(o);r=DChart.Methods.FormatNumber(r);if(p<o){throw new Error(n.WrongParam+n.AxisMaxLessThanMin);}if(p<l){throw new Error(n.WrongParam+n.AxisMaxLessThanActual);}if(o>k){throw new Error(n.WrongParam+n.AxisMinMoreThanActual);}return{interval:r,maxvalue:p,minvalue:o,scalecount:t}};W._formatAxisData=function(e){var f=W.innerOptions;var g=W.innerData;var h=DChart.Const.Language[W.Language];var l=f.labelAxis.valueType;var m=W.tempData.valueAxiaDataIsRange;var n=(!m&&!l&&g[0].value.length>1)||(!m&&l&&g[0].value.length&&g[0].value[0].length==2)||(m&&g[0].value.length>1&&g[0].value[0].length==2);var o=f.valueType||DChart.Const.Defaults.ValueType;var e=e&&n&&!l&&(o=='p'||o=='n');var p=(e||f.valueAxis.verticalcomputeP&&n&&!l)&&o=='p';var q=null;var r=null;var s=null;var t=null;var u=g.length;if(n){u=g[0].value.length}var v=1;if(n){v=g.length}var w=[];if(o=='p'||e){if(n){if(p||e){for(var i=0;i<u;i++){var z=0;for(var j=0,item;item=g[j];j++){z+=(l?item.value[i][1]:item.value[i])}w[i]=z}}else{for(var i=0,item;item=g[i];i++){var z=0;for(var j=0;j<item.value.length;j++){z+=(l?item.value[j][1]:item.value[j])}w[i]=z}}}else{w=0;for(var i=0,item;item=g[i];i++){w+=(l?item.value[1]:item.value)}}}var A=function(a,b,c,i,j,k){if((b=='d'||b=='t')&&!c.getDate){var d=Date.parse(c.replace(/-/g,"/"));if(isNaN(d)){throw new Error(h.WrongData+"'"+c+"'"+h.NeedDateData);}else{c=new Date(d);if(k==undefined){if(j==undefined){g[i].value=c}else{g[i].value[j]=c}}else{if(m&&a&&l){g[i].value[j][1][k]=c}else if(m&&!a){g[i].value[j][0]=c}else{g[i].value[j][k]=c}}}}else if(b=='n'||b=='p'){if(typeof c!='number'){throw new Error(h.WrongData+"'"+c+"'"+h.NeedNumberData);}if(b=='p'){if(c<0){throw new Error(h.WrongData+'\''+c+'\''+h.DataMustGreaterThanZero);}if(k==undefined){if(j==undefined){c=(c/w)*100;g[i].percent=c}else{c=(c/(n?(p?w[j]:w[i]):w))*100;if(n&&!g[i].percent){g[i].percent=[]}if(n){g[i].percent[j]=c}else{g[i].percent=c}}}else{c=(c/(p?w[j]:w[i]))*100;if(!g[i].percent){g[i].percent=[]}g[i].percent[j]=c}}else{if(a&&W.tempData.notAllowValueNegative&&c<0){throw new Error(h.WrongData+'\''+c+'\''+h.DataMustGreaterThanZero);}}}return c};var B=function(a){if(s===null||a>s){s=a}if(t===null||a<t){t=a}};var C=function(a){if(q===null||a>q){q=a}if(r===null||a<r){r=a}};var D=W.tempData.computeSplitPoint;var E=[];var F=function(a,b,c){if(!D){return}if(c){E[b]=[null,null]}if(E[b][0]==null||a<E[b][0]){E[b][0]=a}if(E[b][1]==null||a>E[b][1]){E[b][1]=a}};if(n){for(var i=0,item;item=g[i];i++){for(var j=0;j<item.value.length;j++){var G=item.value[j];var H=null;var I=G;if(l){if(G.length!=2){throw new Error(h.WrongData+"'"+G+"'"+h.AxisVauleShouldBeDArray);}H=G[0];I=G[1]}if(H){H=A(false,l,H,i,j,0);B(H)}if(m){for(var k=0;k<=1;k++){var J=I[k];J=A(true,o,J,i,j,k);C(J)}}else{I=A(true,o,I,i,j,l?1:undefined);C(I);F(I,i,j==0)}}}if(e){if(o=='n'){for(var i=0;i<u;i++){C(w[i])}}else{q=100;r=0}}}else{for(var i=0,item;item=g[i];i++){var H=null;var I=item.value;if(l){if(item.value.length!=2){throw new Error(h.WrongData+"'"+item.value+"'"+h.AxisVauleShouldBeDArray);}H=item.value[0];I=item.value[1]}if(H){H=A(false,l,H,i,0);B(H)}if(m){for(var j=0;j<=1;j++){var J=I[j];J=A(true,o,J,i,j);C(J)}}else{var I=A(true,o,I,i,l?1:undefined);C(I)}}}var K=null;if(D){var L=null;var M=null;for(var i=0,point;point=E[i];i++){var N=point[0];var O=point[1];if(L==null){L=O;M=N}if(O>M&&(L>M||N<M)){M=N}if(N<L&&(L>M||O>L)){L=O}}if(o=='d'||o=='t'){K=new Date((L.getTime()+M.getTime())/2);if(o=='d'){K=new Date(Date.parse(K.format('yyyy/MM/dd')))}}else{K=(L+M)/2}}if(l&&f.labelAxis.sort){var P=function(x,y){if(y.value){if(y.value[0]>x.value[0]){return-1}else{return 1}}else{if(y[0]>x[0]){return-1}else{return 1}}};if(n){for(var i=0,item;item=g[i];i++){item.value.sort(P)}}else{g.sort(P)}}var Q=W._getComputed(1,o,f.valueAxis,r,q,6);var R={vValueType:o,lValueType:l,heapCompute:e,multiple:n,vMaxval:q,vMinval:r,vInterval:Q.interval,vMaxValue:Q.maxvalue,vMinValue:Q.minvalue,vScalecount:Q.scalecount,tuftCount:u,demanCount:v,splitpoint:K};if(l){Q=W._getComputed(0,l,f.labelAxis,t,s,6);R.lValueType=l;R.lInterval=Q.interval;R.lMaxval=s;R.lMinval=t;R.lMaxValue=Q.maxvalue;R.lMinValue=Q.minvalue;R.lScalecount=Q.scalecount}var S=function(){var a=[];var b=f.valueAxis.content;var c=DChart.Methods.CopyInnerValue(R.vValueType,R.vMinValue);for(var i=0;i<=R.vScalecount;i++){a[i]=b.call(f,DChart.Methods.AddInnerValue(R.vValueType,c,R.vInterval*i));c=DChart.Methods.CopyInnerValue(R.vValueType,R.vMinValue)}return a};var T=function(){var a=[];if(R.lValueType){var b=[];var c=f.labelAxis.content;if(typeof c=='function'){var d=DChart.Methods.CopyInnerValue(R.lValueType,R.lMinValue);for(var i=0;i<=R.lScalecount;i++){b[i]=c.call(f.labelAxis,DChart.Methods.AddInnerValue(R.lValueType,d,R.lInterval*i));d=DChart.Methods.CopyInnerValue(R.lValueType,R.lMinValue)}}a=b}else{if(R.multiple){a=f.labelAxis.labels||[]}else{for(var i=0,data;data=W.innerData[i];i++){a[i]=data.text||' '}if(a.__only(' ')&&f.labelAxis.labels&&f.labelAxis.labels.length){a=f.labelAxis.labels}}}return a};R.vLabels=S();R.vScalecount=R.vLabels.length-1;R.lLabels=T();R.lScalecount=R.lLabels.length-1;W.tempData.axisData=R;return R};W._computeAxis=function(a){if(!a.AxisValid){return null}var b=W.innerOptions;var c=W.tempData.axisData;var d=W.tempData.invertAxis;var e=W.innerOptions.background.borderwidth||0;var a=a||W._calculateOutersValid();var f=a.legendValid?W._computeLegend():null;var g=W.canvas.height/35;if(a.titleValid){g=W._computeTitle(a).occupyTop}var h=W.canvas.width-e*2-(f?f.occupyLeft:0)-(f?f.occupyRight:0);var i=W.canvas.height-e*2-g-(f?f.occupyTop:0)-(f?f.occupyBottom:0);var j=h/(d?8:DChart.Const.Defaults.AxisYDrawableCut[c.vValueType]);var k=i/DChart.Const.Defaults.AxisXDrawableCut;var l=b.labelAxis.length||(d?j:k);var m=b.valueAxis.length||(d?k:j);var n=d?l:m;var o=d?m:l;var p=d?n/8:(a.titleValid||f&&f.occupyTop>0?o/8:g*2.5);var q=(a.legendValid&&f.placeY=='middle'?p/2:n/3);var r=b.scale.linewidth==null?1:b.scale.linewidth;var s=b.close.linewidth||r||1;var t=b.labelAxis.linewidth==null?1:b.labelAxis.linewidth;var u=b.valueAxis.linewidth==null?1:b.valueAxis.linewidth;var v=d?u:t;var w=d?t:u;var x=(d?h-q-n-p:i-o-p)/c.vScalecount;var y=b.cross.length||m/15;var z=W.canvas.width-e-q-(f?f.occupyRight:0)-(d?p:0);var A=W.canvas.height-o-e-(f?f.occupyBottom:0);var B=d?(z-c.vScalecount*x):(e+n+(f?f.occupyLeft:0));var C=d?(e+g+(f&&f.occupyTop>0?f.occupyTop:o/10)):(A-c.vScalecount*x);var D=c.multiple;var E=c.lLabels.length||(D?W.innerData[0].value.length:W.innerData.length);var F=DChart.Const.AxisFromFirstLeft.__contains(W.GraphType);var G=0;var H=0;var I=d?A-C:z-B;var J=d?z-B:A-C;if(!F){G=b.labelAxis.startlength;H=b.labelAxis.endlength;if(G==null&&H==null){G=I/(E+1/3)*2/3;H=G}else if(G==null&&H!=null){G=H}else if(H==null&&G!=null){H=G}if(G<0||H<0||G+H>I){var K=DChart.Const.Language[W.Language];throw new Error(K.WrongParam+K.LabelDistanceExceedMax);}}var L=(d?A:B)+(d?-H:G);var M=(I-G-H)/(E-1);var N=null;if(DChart.Const.DrawSplitLine.__contains(W.GraphType)){N=(d?B:C)+J*W._getFormatDiff(c.vValueType,(d?c.vMinValue:c.vMaxValue),c.splitpoint)/W._getFormatDiff(c.vValueType,c.vMinValue,c.vMaxValue)}W.axisSize={labelAxisLength:l,valueAxisLength:m,yAxisWidth:n,xAxisHeight:o,minX:Math.ceil(B),maxX:Math.ceil(z),minY:Math.ceil(C),maxY:Math.ceil(A),axisValueCut:x,crossLength:y,scaleLineWidth:r,closeLineWidth:s,labelAxisLineWidth:t,valueAxisLineWidth:u,xAxisLineWidth:v,yAxisLineWidth:w,startPos:L,labelDistance:M,splitLinePos:N};return W.axisSize};W._createAxis=function(o){var o=o||W._calculateOutersValid();if(!o.AxisValid){return}W.coordinates.axis={};var p=W.innerOptions;var q=p.background.borderwidth||0;if(typeof p.valueAxis.content!='function'){return}var r=W.tempData.axisData;var s=W.axisSize||W._computeAxis(o);var t=W.tempData.invertAxis;var u=r.vValueType=='d'||r.vValueType=='t';var v=r.lValueType=='d'||r.lValueType=='t';var w=p.valueAxis.fontsize||(t?1.3:1)*(s.valueAxisLength-s.valueAxisLineWidth)/(u?7:5);var z=p.valueAxis.fontweight||'normal';var A=p.valueAxis.fontfamily||p.fontFamily||DChart.Const.Defaults.FontFamily;var B=p.valueAxis.fontcolor;var C=p.valueAxis.linecolor||DChart.Const.Defaults.AxisLineColor;var D=(p.cross.show?s.crossLength:3)+s.valueAxisLineWidth+3;var E=function(a,b,c,d,e,f){if(a==null){a=0;var g=true;while(g){var h=false;var j=Math.cos(a*Math.PI);var k=Math.abs(a*Math.PI);for(var i=0;i<=c.length-1;i++){var l=W.DrawFigures.measureText(c[i],d,e,f);if(b){if(l*j>s.yAxisWidth-D){h=true;break}}else{var m=i==0?0:W.DrawFigures.measureText(c[i-1],d,e,f);var n=t?s.valueAxisLength:s.labelDistance;if(i>0&&n*k<e&&(l+m>2*n/j)){h=true;break}}}g=h;if(h){a-=0.01}}}return a};var F=function(a,x,y,b){var c=r.vLabels;var d=s.minX-D;var e=s.maxY+(p.cross.show?s.crossLength:3)+s.valueAxisLineWidth+3+w;var f=E(p.valueAxis.fontrotate,!t,c,z,w,A);W.coordinates.axis.vlabels=[];for(var i=0;i<=r.vScalecount;i++){if(t){var g=s.minX+i*s.axisValueCut;var h=W.DrawFigures.createText(c[i],g,e,'center',z,w,A,B,f,'right');W.coordinates.axis.vlabels[i]={index:i,left:g-h/2,right:g+h/2,top:e-w,bottom:e,fontsize:w,length:h}}else{var j=s.maxY-i*s.axisValueCut+s.scaleLineWidth/2+w/3;var h=W.DrawFigures.createText(c[i],d,j,'right',z,w,A,B,f);W.coordinates.axis.vlabels[i]={index:i,left:d-h,right:d,top:j-w,bottom:j,fontsize:w,length:h}}}};var G=function(){if(!p.cross.show){return}var a=p.scale.backcolors&&p.scale.backcolors.length>1;var b=p.cross.linewidth;var c=p.cross.linecolor||C;var d=s.crossLength;if(t){var e=s.maxY+s.valueAxisLineWidth;var f=s.maxY+s.valueAxisLineWidth+s.crossLength;var g=Math.floor((s.scaleLineWidth+0.1)/2);for(var i=1;i<=r.vScalecount;i++){var x=s.maxX-i*s.axisValueCut;if(i==r.vScalecount&&x<s.minX){x=s.minX}if(a&&i<r.vScalecount){x-=g}W.DrawFigures.createLine(x+s.axisValueCut,e,x+s.axisValueCut,f,p.cross.linewidth,c)}W.DrawFigures.createLine(s.minX-1,e,s.minX-1,f,p.cross.linewidth,c)}else{var h=s.minX-s.valueAxisLineWidth;var j=h-s.crossLength;for(var i=1;i<=r.vScalecount;i++){var y=s.maxY-i*s.axisValueCut;if(a){y+=s.scaleLineWidth/2}W.DrawFigures.createLine(j,y,h,y,b,c)}W.DrawFigures.createLine(j,s.maxY+1,h,s.maxY+1,b,c)}};if(s.valueAxisLineWidth&&s.valueAxisLineWidth>0){if(t){var y=s.maxY+s.valueAxisLineWidth/2;W.DrawFigures.createLine(s.minX-s.labelAxisLineWidth,y,s.maxX+s.valueAxisLength/20,y,s.valueAxisLineWidth,C)}else{var x=s.minX-s.valueAxisLineWidth/2;W.DrawFigures.createLine(x,s.maxY+s.labelAxisLineWidth+1,x,s.minY-s.valueAxisLength/20,s.valueAxisLineWidth,C)}}var H=function(){var a=r.lLabels;var b=p.labelAxis.fontsize||(v?s.xAxisHeight/6:s.xAxisHeight/4.5);var c=p.labelAxis.fontweight||z;var d=p.labelAxis.fontfamily||A;var e=p.labelAxis.fontcolor||B;var f=E(p.labelAxis.fontrotate,t,a,c,b,d);W.coordinates.axis.llabels=[];for(var i=0,label;label=a[i];i++){if(t){var g=s.minX-s.valueAxisLineWidth-b*(f<0?1:0.5);var h=s.startPos-(s.labelDistance)*i+b/2;var j=W.DrawFigures.createText(label,g,h,'right',c,b,d,e,f);W.coordinates.axis.llabels[i]={index:i,left:g-j,right:g,top:h-b,bottom:h,fontsize:b,length:j}}else{var k=s.startPos+(s.labelDistance)*i;var h=s.maxY+s.labelAxisLineWidth+b*1.2;var j=W.DrawFigures.createText(label,k,h,'center',c,b,d,e,f,'right');W.coordinates.axis.llabels[i]={index:i,left:k-j/2,right:k+j/2,top:h-b,bottom:h,fontsize:b,length:j}}}};if(s.labelAxisLineWidth&&s.labelAxisLineWidth>0){if(t){var x=s.minX-s.labelAxisLineWidth/2;W.DrawFigures.createLine(x,s.minY-(p.close.show?s.closeLineWidth:0),x,s.maxY,s.labelAxisLineWidth,p.labelAxis.linecolor||DChart.Const.Defaults.AxisLineColor)}else{var y=s.maxY+s.labelAxisLineWidth/2+1;W.DrawFigures.createLine(s.minX-1,y,s.maxX+(p.close.show?s.closeLineWidth:0),y,s.labelAxisLineWidth,p.labelAxis.linecolor||DChart.Const.Defaults.AxisLineColor)}}var I=function(){if(typeof p.caption.content!='string'){return}var a=p.caption.fontsize||(w+(u?2:-1));if(t){var b=Math.min(s.maxX+a*1.5,W.canvas.width-q-a);var c=s.maxY+s.xAxisLineWidth/2;var d=W.DrawFigures.createText(p.caption.content,b,c,'center',p.caption.fontweight,a,p.caption.fontfamily,p.caption.fontcolor||B,0.5);W.coordinates.axis.caption={left:b,right:b+a,top:c-d/2,bottom:c+d/2,fontsize:a,length:d}}else{var b=s.minX-s.valueAxisLineWidth/2;var e=s.minY-a;var d=W.DrawFigures.createText(p.caption.content,b,e,'center',p.caption.fontweight,a,p.caption.fontfamily,p.caption.fontcolor||B);W.coordinates.axis.caption={left:b-d/2,right:b+d/2,top:e-a,bottom:e,fontsize:a,length:d}}};var J=function(){if(!(p.close.show&&s.closeLineWidth&&s.closeLineWidth>0)){return}var a=p.close.linecolor||p.scale.linecolor||DChart.Const.Defaults.ScaleLineColor;if(t){var b=s.minY-s.closeLineWidth/2;W.DrawFigures.createLine(s.minX,b,s.maxX,b,s.closeLineWidth,a)}else{var c=s.maxX+s.closeLineWidth/2;W.DrawFigures.createLine(c,s.maxY+1,c,s.minY,s.closeLineWidth,a)}};var K=function(){var a=p.yAxisTitle;if(!a.content){return}var b=a.fontsize||s.yAxisWidth/5;var c=a.fontweight||'bold';var d=(s.minY+s.maxY)/2;var e=s.minX-s.yAxisLineWidth-(s.yAxisWidth-s.yAxisLineWidth)*(a.titlelocation||(t?0.75:DChart.Const.Defaults.AxisYTitleLocation[r.vValueType]));var f=W.DrawFigures.createText(a.content,e,d,'center',c,b,a.fontfamily,a.fontcolor,-0.5);W.coordinates.axis.yAxisTitle={top:d-f/2,bottom:d+f/2,left:e-b,right:e,fontsize:b,length:f}};var L=function(){var a=p.xAxisTitle;if(!a.content){return}var b=a.fontsize||s.xAxisHeight/5;var c=a.fontweight||'bold';var d=W.canvas.width/2;var e=s.maxY+s.xAxisLineWidth+(s.xAxisHeight-s.xAxisLineWidth)*(a.titlelocation||(t?0.75:DChart.Const.Defaults.AxisXTitleLocation[r.vValueType]));var f=W.DrawFigures.createText(a.content,d,e,'center',c,b,a.fontfamily,a.fontcolor);W.coordinates.axis.xAxisTitle={top:e-b,bottom:e,left:d-f/2,right:d+f/2,fontsize:b,length:f}};I();K();L();F();H();G();J();W.coordinates.axis.yAxis={width:s.yAxisWidth};W.coordinates.axis.xAxis={height:s.xAxisHeight}};W._createFooter=function(){var a=W.innerOptions.footer;if(!a.content){return}var b=W.coordinates.canvas;var c=a.fontsize||Math.min(b.height/25,b.width/50);var d=b.height*(1-(a.bottomdistance||DChart.Const.Defaults.FooterBottomDistance))-b.borderwidth-c/2;var e=b.width*(1-(a.rightdistance||DChart.Const.Defaults.FooterRightDistance))-b.borderwidth;var f=a.fontcolor||DChart.Const.Defaults.FooterFontColor;var g=W.DrawFigures.createText(a.content,e,d,'right',a.fontweight,c,a.fontfamily,f);W.coordinates.footer={top:d-c,bottom:d,right:e,left:e-g,fontsize:c,length:g}};W._createScales=function(a){var a=a||W._calculateOutersValid();if(!a.AxisValid){return}var b=W.innerOptions;var c=W.axisSize||W._computeAxis(a);var d=W.tempData.axisData;var e=c.scaleLineWidth;var f=Math.floor((e+0.1)/2);var g=b.scale.linecolor||DChart.Const.Defaults.ScaleLineColor;var h=b.scale.backcolors;var j=W.tempData.invertAxis;if(h&&h.length==1){W.DrawFigures.createRectangleFill(c.minX,c.minY,c.maxX-c.minX,c.maxY-c.minY,h[0])}for(var i=1;i<=d.vScalecount;i++){if(j){var x=c.maxX-i*c.axisValueCut;if(i==d.vScalecount&&x<c.minX){x=c.minX}if(h&&h.length>1){var k=h.length?h[(i-1)%h.length]:null;if(i<d.vScalecount){x-=f}W.DrawFigures.createRectangleFill(x,c.minY,c.axisValueCut-f,c.maxY-c.minY,k)}if(e>0){W.DrawFigures.createLine(x+c.axisValueCut,c.minY,x+c.axisValueCut,c.maxY,e,g)}}else{var y=c.maxY-i*c.axisValueCut;if(h&&h.length>1){var k=h.length?h[(i-1)%h.length]:null;y+=e/2;var l=c.axisValueCut-e/2;if(i==1){l+=1}W.DrawFigures.createRectangleFill(c.minX,y,c.maxX-c.minX,l,k)}if(e>0){W.DrawFigures.createLine(c.minX,y,c.maxX,y,e,g)}}}if(b.scale.drawvertical){var m=b.close.show&&c.closeLineWidth&&c.closeLineWidth>0;for(var i=1;i<d.lScalecount+(m?0:1);i++){if(j){var n=c.startPos-i*c.labelDistance;if(e>0){W.DrawFigures.createLine(c.minX,n,c.maxX,n,e,g)}}else{var n=c.startPos+i*c.labelDistance;if(e>0){W.DrawFigures.createLine(n,c.minY,n,c.maxY+1,e,g)}}}}if(DChart.Const.DrawSplitLine.__contains(W.GraphType)&&b.splitLine.show){var o=b.splitLine.linecolor;var p=b.splitLine.linewidth;if(j){W.DrawFigures.createLine(c.splitLinePos,c.minY,c.splitLinePos,c.maxY,p||1,o)}else{W.DrawFigures.createLine(c.minX,c.splitLinePos,c.maxX,c.splitLinePos,p||1,o)}}};W._calculateOutersValid=function(){var a=W.innerOptions;var b=a.legend.show;if(W.tempData.axisData&&!W.tempData.axisData.multiple||W.tempData.legendInvalid){b=false}var c=a.title&&a.title.show&&a.title.content;var d=c&&a.subTitle&&a.subTitle.show&&a.subTitle.content;var e=DChart.Const.DrawAxis.__contains(W.GraphType);return{legendValid:b,titleValid:c,subTitleValid:d,AxisValid:e}};W._createAssists=function(a){W._createBackground();W._createTitle(a);W._createLegend();W._createAxis(a);W._createFooter()};W._startDrawAndAnimation=function(b,c){var d=W.innerOptions;var e=(d.animation)?1/DChart.Methods.CapValue(d.animationSteps,100,1):1;var f=DChart.Const.AnimationAlgorithms[d.animationEasing];var g=(d.animation)?0:1;var h=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,1000/60)};var i=W._calculateOutersValid();W.ClearBackGround();if(!W.tempData.recreateAssists){W._createAssists(i)}var j=W._getDrawableCoordinate();if(W.onBeforeAnimation){W.onBeforeAnimation()}var k=function(){g+=e;if(W.onAnimation){W.onAnimation(g)}var a=(d.animation)?DChart.Methods.CapValue(f(g),null,0):1;W._clearDrawable(j);if(!i.AxisValid||W.tempData.recreateAssists){W._createAssists(i)}if(d.scaleOverlay){b(a,g);W._createScales(i)}else{W._createScales(i);b(a,g)}if(g<1){h(k)}else{if(d.supportMouseEvents&&typeof c=='function'){c()}if(typeof d.onAnimationComplete=='function'){d.onAnimationComplete()}if(W.onFinish){W.onFinish()}}};h(k)};W._computeRadiusForPies=function(a){var b=W._getDrawableCoordinate();var c=DChart.Methods.IsNumber(a.offX)?a.offX:0;var d=DChart.Methods.IsNumber(a.offY)?a.offY:0;var e=(b.maxX-b.minX)/2;var f=(b.maxY-b.minY)/2;var g=Math.min(e,f);var h=a.margin==null&&(a.radar||a.outerLabel.show)?g/6:g/10;if(DChart.Methods.IsNumber(a.margin)&&a.margin>0){h=a.margin}if(c<0&&e<-c){c=-e/2}if(c>0&&e<c){c=e/2}if(d<0&&f<-d){d=-f/2}if(d>0&&f<d){d=f/2}var i=Math.min(e-Math.abs(c),f-Math.abs(d))-h;return{coordinate:b,maxRadius:i,centerX:b.centerX+c,centerY:b.centerY+d}};W._getMouseLoction=function(e){if(e.offsetX!=null){return{X:e.offsetX,Y:e.offsetY}}else{var c=function(a){var b={x:0,y:0};while(a){b.x+=a.offsetLeft;b.y+=a.offsetTop;a=a.offsetParent}return b};var d=e.target;if(d.offsetLeft==undefined){d=d.parentNode}var f=c(d);var g={x:window.pageXOffset+e.clientX,y:window.pageYOffset+e.clientY};return{X:g.x-f.x,Y:g.y-f.y}}};W._computeSegmentTotal=function(){var b=null;var c=null;var d=0;var e=[];var f=W.innerData[0].value.length;var g=f!=undefined;var h=function(a){if(typeof a!='number'){throw new Error(W._messages.WrongData+'\''+a+'\''+W._messages.NeedNumberData);}else if(a<0){throw new Error(W._messages.WrongData+'\''+a+'\''+W._messages.DataMustGreaterThanZero);}else{if(c==null){b=c=a}else{if(a>c){c=a}else if(a<b){b=a}}return a}};for(var k=0;k<(g?f:1);k++){var j=0;for(var i=0,item;item=W.innerData[i];i++){var l=h(g?item.value[k]:item.value);d+=l;j+=l}e[k]=j}return{multiple:g,segmentTotal:d,segmentTotals:e,minval:b,maxval:c}};W.Initial()};return be};